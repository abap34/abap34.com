<!DOCTYPE html>
<html lang="ja" prefix="og: http://ogp.me/ns#">
<meta charset="UTF-8">

<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-10Y7GMS7GV"></script>
    <script>
        if (location.hostname !== "localhost") {
            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            gtag('js', new Date());
            gtag('config', 'G-10Y7GMS7GV');
        }
    </script>

    <script type="text/javascript" src="//code.typesquare.com/static/ZDbTe4IzCko%253D/ts106f.js"
        charset="utf-8"></script>

    <title>Julia Compiler Internals (06) - Implementing Small Julia Compiler</title>

    <!-- OGP / Twitter ç”¨ã®ãƒ¡ã‚¿ã‚¿ã‚° -->
    <meta property="og:title" content="Julia Compiler Internals (06) - Implementing Small Julia Compiler">
    <meta property="og:image" content="https://abap34.com/posts/jci_06/image.png">
    <meta property="og:description" content="å¤šé‡ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã¨æŠ½è±¡è§£é‡ˆã«åŸºã¥ãå‹æ¨è«–ãŒè¼‰ã£ãŸå‡¦ç†ç³»ã‚’ä½œã‚Šã¾ã™ã€‚">
    <meta property="og:url" content="https://abap34.com/posts/jci_06.html">
    <meta property="og:type" content="article">
    <meta property="og:site_name" content="abap34's blog">
    <meta property="og:locale" content="ja_JP">
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="abap34" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- ãƒã‚¤ãƒ©ã‚¤ãƒˆJS / FontAwesome -->
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.0/styles/a11y-light.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.0/languages/julia.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.0/languages/julia-repl.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.0/languages/scheme.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.0/languages/dockerfile.min.js"></script>
    <script>hljs.highlightAll();</script>

    <!-- ãã®ä»–ãƒ©ã‚¤ãƒ–ãƒ©ãƒª -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.3.2/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.0/ace.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.0/ext-language_tools.js"></script>
    <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

    <!-- å¤–éƒ¨CSSã‚’èª­ã¿è¾¼ã‚€ (ä»¥ä¸‹ãŒå¾Œè¿°ã® style.css) -->
    <style>/* ===============================================
   Reset / Base
   =============================================== */
*,
*::before,
*::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

html,
body {
    width: 100%;
    min-height: 100vh;
    /* ç”»é¢å…¨ä½“ã«èƒŒæ™¯ãŒä¼¸ã³ã‚‹ã‚ˆã†ã«ã™ã‚‹ */
    background-color: #fff;
    color: #333;
    font-family: monospace;
    line-height: 1.5;
    /* æ–‡å­—ã¡ã‚‡ã£ã¨ */
    /*  global-header ã®ã¶ã‚“ã‚’æŠ¼ã—ä¸‹ã’ã‚‹ */
    /* padding-top: 3.0rem; */
    /* â†‘ global-headerå´ä¸‹ã’ãŸ */

    /* é•·ã„å˜èªã‚‚å¼·åˆ¶çš„ã«æ”¹è¡Œ */
    word-wrap: break-word;
}

/* ===============================================
      Layout
      =============================================== */
.article-body {
    display: flex;
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 1rem;
    gap: 2rem;
}

.side {
    width: 240px;
    flex-shrink: 0;
}

.side-sticky {
    position: sticky;
    top: 3.5rem;
}

.sidebar {
    padding: 0.5rem;
    max-height: 80vh;
    overflow-y: auto;
}

.content {
    flex: 1;
    padding: 0.5rem;
    min-width: 0;
    /* å†…å®¹ãŒã‚ãµã‚Œã«ãã„ã‚ˆã†ã« */
}

/* ===============================================
      Header
      =============================================== */
/* ä¸€ç•ªä¸Šã«å¸¸ã«å›ºå®šã™ã‚‹ãƒ˜ãƒƒãƒ€ */
.global-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 999;
    background: #fff;
    border-bottom: 1px solid #ddd;
    padding: 0.5rem 1rem;

    /* è¦ç´ ã¯æ¨ªã«ä¸¦ã¹ã‚‹ */
    display: flex;
    justify-content: space-between;
    align-items: center;

}

.article-header {
    padding: 1rem;
    /* margin-bottom: 1rem; */
    padding-top: 6rem;
    max-width: 800px;
    margin: 0 auto;
}

.title {
    font-size: 1.5rem;
    font-weight: bold;
    margin-bottom: 0.5rem;
}

.date {
    font-size: 0.9rem;
    color: #777;
    margin-bottom: 0.5rem;
}

.tag-placeholder {
    margin-top: 0.5rem;
}

.tag {
    display: inline-block;
    margin-right: 0.4rem;
    padding: 0.2rem 0.4rem;
    border-radius: 4px;
    background-color: #eee;
    font-size: 0.8rem;
    color: #333;
}

.tag:hover {
    background-color: #ddd;
}

.tag a {
    color: inherit;
    text-decoration: none;
}

/* ===============================================
      TOC 
      =============================================== */
.toc_title {
    display: none;
}

#toc {
    list-style: none;
    padding-left: 0;
    font-size: 0.9rem;
    color: #555;
    line-height: 1.4;
}

#toc li {
    margin: 0.4rem 0;
}

#toc a {
    text-decoration: none;
    color: #555;
    padding: 0.2rem 0.4rem;
    border-radius: 3px;
    transition: background-color 0.1s, opacity 0.1s;
    opacity: 1;
}

#toc a:hover {
    background-color: #f0f0f0;
    opacity: 1;
}

#toc a.active {
    background-color: #777;
    color: #fff;
    opacity: 1 !important;
}

/* éšå±¤ã«ã‚ˆã‚‹ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆ */
.toc_H1 {
    margin-left: 0;
}

.toc_H2 {
    margin-left: 1rem;
}

.toc_H3 {
    padding-left: 1.5rem;
}

/* ===============================================
      Content
      =============================================== */

/* è¦‹å‡ºã—ã®è¦‹ãŸç›®ã‚’å°‘ã—æ”¹å–„ã—ã€ä¸‹ç·šã¨ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’è¿½åŠ  */
.content h1,
.content h2,
.content h3,
.content h4,
.content h5,
.content h6 {
    font-weight: bold;
    margin-top: 2rem;
    margin-bottom: 1rem;
    border-bottom: 1px solid #ccc;
    padding-bottom: 0.3rem;
    color: #333;
}

h5 {
    font-size: 1.1rem;
}

.content p {
    margin-bottom: 1rem;
}

/* ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’æœ¬æ–‡ã¨åŒºåˆ¥ã—ã‚„ã™ã */
.content code {
    background-color: #f6f8fa;
    border: 1px solid #ddd;
    border-radius: 4px;
    padding: 0.1rem 0.3rem;
    font-size: 0.95em;
}

/* ç®‡æ¡æ›¸ãã®å­—ä¸‹ã’ */
.content ul,
.content ol,
.content dl {
    margin-left: 1.5rem !important;
}

/* ç”»åƒã‚„å‹•ç”»ã®ã¯ã¿å‡ºã—å¯¾ç­– (ç‰¹ã«ç¸¦é•·ç”»åƒ) */
.content img,
.content video {
    max-width: 80%;
    max-height: 80vh;
    /* ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã®80%ã‚’ä¸Šé™ã« */
    height: auto;
    display: block;
    border: 1px solid #ddd;
    /* çœŸã‚“ä¸­ã«ç½®ã */
    margin: 1rem auto;
}


/* ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯å†…ã®è¡Œé–“ã‚’åºƒã’å¯èª­æ€§ã‚’å‘ä¸Š */
pre code {
    display: block;
    white-space: pre;
    border: none;
    background: none;
    line-height: 1.4;
    margin: 1rem;
}

/* ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‡ã‚¶ã‚¤ãƒ³ (ã‚·ãƒ³ãƒ—ãƒ«ï¼†è¦‹ã‚„ã™ã„) */
table {
    width: 100%;
    border-collapse: collapse;
    /* ä½™åˆ†ãªéš™é–“ã‚’é™¤å» */
    margin: 1rem 0;
    font-size: 0.95rem;
    line-height: 1.4;
    margin: 1rem;
}

table thead th {
    background-color: #f6f8fa;
    border-bottom: 2px solid #ccc;
    padding: 0.6rem 0.8rem;
    text-align: left;
    font-weight: bold;
}

table th,
table td {
    border: 1px solid #ddd;
    padding: 0.5rem 0.8rem;
    vertical-align: top;
}

table tbody tr:nth-child(even) {
    background-color: #f9f9f9;
    /* å¶æ•°è¡Œã«è–„ã„èƒŒæ™¯ */
}

table tbody tr:hover {
    background-color: #f0f0f0;
    /* ãƒ›ãƒãƒ¼æ™‚ã®å¼·èª¿ */
}

content a {
    word-break: break-all;
    color: #80bdff;
    text-decoration: none;
}

iframe {
    width: 100%;
}

figure {
    margin: 1rem 0;
}

figcaption {
    color: #777;
    /* çœŸã‚“ä¸­ã«ç½®ã */
    display: block;
    margin-top: 0.5rem;
    text-align: center;
}

/* ===============================================
      Footer
      =============================================== */
footer {
    margin-top: 2rem;
    text-align: center;
    font-size: 0.8rem;
    color: #666;
}

/* ===============================================
      Responsive
      =============================================== */
@media (max-width: 768px) {
    .article-body {
        flex-direction: column;
        padding: 0 1rem;
    }

    .side {
        width: 100%;
        margin-bottom: 1.5rem;
        /* height: 100vh; ã‚’å‰Šé™¤ã€autoã« */
        height: auto;
    }

    .content {
        width: 100%;
    }
}

/* ===============================================
      Note / Warn / Danger blocks
      =============================================== */
.info {
    background-color: #f0f0f0;
    padding: 1rem;
    border-left: 5px solid #80bdff;
    margin: 1rem;

}

/* Warn: ã¡ã‚‡ã£ã¨å¼·ã‚ã®æ³¨æ„å–šèµ· (ã‚ªãƒ¬ãƒ³ã‚¸ç³») */
.warn {
    background-color: #fff3e0;
    /* è–„ã„ã‚ªãƒ¬ãƒ³ã‚¸ */
    padding: 1rem;
    border-left: 5px solid #ffa500;
    /* ã‚ªãƒ¬ãƒ³ã‚¸ */
    margin: 1rem;
}

/* Danger: é‡å¤§ãªè­¦å‘Š (èµ¤ç³») */
.danger {
    background-color: #ffe7e7;
    /* è–„ã„èµ¤ */
    padding: 1rem;
    border-left: 5px solid #ff4d4f;
    /* èµ¤ */
    margin: 1rem;
}

/* ===============================================
      Math Blocks (theorem / lemma / corollary / etc.)
      =============================================== */

/* Theorem / Lemma / Corollary / Proposition / Definition / Proof ãã‚Œãã‚Œã«å…±é€šã™ã‚‹ãƒ™ãƒ¼ã‚¹ */
/* ãƒ™ãƒ¼ã‚¹: èƒŒæ™¯ã¯é€æ˜ã€å·¦ã«å¤ªç·šã®ã¿ */
.theorem,
.lemma,
.corollary,
.proposition,
.definition,
.proof {
    margin-top: 1rem;
    margin-bottom: 1rem;
    padding: 1rem;
    background: none;
    border: 1px solid #ddd;
}

/* Theorem */
.theorem {
    counter-increment: theorem;
}

.theorem::before {
    content: "Theorem " counter(theorem) " ";
    font-weight: bold;
    color: #333;
}

/* Lemma */
.lemma {
    counter-increment: lemma;
}

.lemma::before {
    content: "Lemma " counter(lemma) " ";
    font-weight: bold;
    color: #333;
}

/* Corollary */
.corollary {
    counter-increment: corollary
}

.corollary::before {
    content: "Corollary " counter(corollary) " ";
    font-weight: bold;
    color: #333;
}

/* Proposition */
.proposition {
    counter-increment: proposition;
}

.proposition::before {
    content: "Proposition " counter(proposition) " ";
    font-weight: bold;
    color: #333;
}

/* Definition */
.definition {
    counter-increment: definition;
}

.definition::before {
    content: "Definition " counter(definition) " ";
    font-weight: bold;
    color: #333;
}

/* Proof */
.proof {
    counter-increment: proof;
}

.proof::before {
    content: "Proof " counter(proof) " ";
    font-weight: bold;
    color: #333;
}

/* æœ€å¾Œã®æ®µè½ãŒä½™è¨ˆãªä¸‹ä½™ç™½ã‚’å–ã‚‰ãªã„ãŸã‚ã®èª¿æ•´ */
.theorem p:last-child,
.lemma p:last-child,
.corollary p:last-child,
.proposition p:last-child,
.definition p:last-child,
.proof p:last-child {
    margin-bottom: 0;
}

/* mathjax ã®è¦ç´ ã‚’å°‘ã—å°ã•ã‚ã«è¡¨ç¤º */


.math-block {
    overflow-x: auto;
    overflow-y: hidden;
}

.math-inline {
    display: inline-grid;
    overflow: hidden !important;
    font-size: 0.9em;
    max-width: 100%;
}

/* ===============================================
      Footnotes
        =============================================== */

/* è„šæ³¨ãƒªãƒ³ã‚¯ã®ã‚¹ã‚¿ã‚¤ãƒ« */


.footnote-ref {
    font-size: 0.8em;
    vertical-align: super;
    color: #777;
}

.footnote-ref a {
    color: #777;
    text-decoration: none;
}

.footnote-ref a:hover {
    text-decoration: underline;
}

/* è„šæ³¨æœ¬ä½“ã®ã‚¹ã‚¿ã‚¤ãƒ« */
.footnotes {
    margin-top: 1rem;
    padding: 1rem;
    border: 1px solid #ddd;
    font-size: 0.9em;
}

.footnote-def {
    margin-bottom: 0.5rem;
    /* æ”¹è¡Œ */
    padding: 0.2rem 0.5rem;
    border-left: 3px solid #ddd;
    display: block;
}

.footnote-def p {
    margin-bottom: 0;
}



/* ========================== */
/* ã“ã“ã‹ã‚‰ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆç”¨ã®ã‚¹ã‚¿ã‚¤ãƒ« */
/* ========================== */
/* â–¼ ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ç”¨ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ (ãƒ¦ãƒ¼ã‚¶ãŒæ‰‹å‹•ã§ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠã—ãŸå ´åˆ) */
body.dark-mode {
    background-color: #1f2022 !important;
    color: #e0e0e0 !important;
}

body.side.dark-mode {
    background-color: #1f2022 !important;
}

body.dark-mode .article-body {
    background-color: #1f2022 !important;
    color: #e0e0e0 !important;
}


body.dark-mode .global-header {
    background-color: #1f20229a !important;
    border-bottom: 1px solid #444 !important;
    color: #e0e0e0 !important;
}

body.dark-mode .code {
    background-color: #595959 !important;
}

body.dark-mode .article-header {
    color: #e0e0e0 !important;
}

body.dark-mode .content {
    color: #e0e0e0 !important;
}

body.dark-mode .content h1,
body.dark-mode .content h2,
body.dark-mode .content h3,
body.dark-mode .content h4,
body.dark-mode .content h5,
body.dark-mode .content h6 {
    color: #e0e0e0 !important;
    border-bottom: 1px solid #555 !important;
}

body.dark-mode .content code {
    background-color: #2d2d2d !important;
    border: 1px solid #555 !important;
    color: #e0e0e0 !important;
}

body.dark-mode pre code {
    background-color: #2d2d2d !important;
    color: #e0e0e0 !important;
}

body.dark-mode .content a {
    color: #8ab4f8 !important;
}

body.dark-mode table thead th {
    background-color: #333 !important;
    border-bottom: 2px solid #555 !important;
    color: #e0e0e0 !important;
}

body.dark-mode table th,
body.dark-mode table td {
    border: 1px solid #555 !important;
    color: #e0e0e0 !important;
}

body.dark-mode table tbody tr:nth-child(even) {
    background-color: #1e1e1e !important;
}

body.dark-mode table tbody tr:hover {
    background-color: #2a2a2a !important;
}

body.dark-mode .tag {
    background-color: #333 !important;
    color: #e0e0e0 !important;
}

body.dark-mode .tag:hover {
    background-color: #444 !important;
}

body.dark-mode #toc {
    color: #bbb !important;
}

body.dark-mode #toc a {
    color: #bbb !important;
}

body.dark-mode #toc a.active {
    background-color: #555 !important;
    color: #fff !important;
}

body.dark-mode footer {
    color: #aaa !important;
}


body.dark-mode .info {
    background-color: #2a2a2a !important;
    border-left: 5px solid #80bdff !important;
    color: #e0e0e0 !important;
}

body.dark-mode .warn {
    background-color: #3a2a1a !important;
    border-left: 5px solid #ffb74d !important;
    color: #e0e0e0 !important;
}

body.dark-mode .danger {
    background-color: #4a1a1a !important;
    border-left: 5px solid #ff4d4f !important;
    color: #e0e0e0 !important;
}

body.dark-mode .theorem,
body.dark-mode .lemma,
body.dark-mode .corollary,
body.dark-mode .proposition,
body.dark-mode .definition,
body.dark-mode .proof {
    border: 1px solid #555 !important;
    color: #e0e0e0 !important;
}

body.dark-mode .footnotes {
    border: 1px solid #555 !important;
    color: #e0e0e0 !important;
}

body.dark-mode .footnote-def {
    border-left: 3px solid #555 !important;
    color: #e0e0e0 !important;
}

body.dark-mode a {
    color: #8ab4f8 !important;
}

body.dark-mode a:hover {
    color: #8ab4f8 !important;
}

body.dark-mode .timeline {
    background-color: #2a2b2f !important;
    border: 1px solid #444 !important;
    color: #e0e0e0 !important;
}


body.dark-mode .theorem::before,
body.dark-mode .lemma::before,
body.dark-mode .corollary::before,
body.dark-mode .proposition::before,
body.dark-mode .definition::before,
body.dark-mode .proof::before {
    color: #e0e0e0 !important;
}

body.dark-mode button {
    background-color: #333 !important;
    color: #e0e0e0 !important;
    /* è£…é£¾ãªã— */
    border: none;
    /* ãƒã‚¦ã‚¹ã‚ªãƒ¼ãƒãƒ¼æ™‚ã®ã‚«ãƒ¼ã‚½ãƒ« */
    cursor: pointer;
}


/* â–¼ ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰å¼·åˆ¶ç”¨ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ (ãƒ¦ãƒ¼ã‚¶ãŒæ˜ç¤ºçš„ã«ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠã—ãŸå ´åˆ) */
body.light-mode {
    background-color: #fff !important;
    color: #333 !important;
}

body.light-mode .global-header {
    background-color: #fff !important;
    border-bottom: 1px solid #ddd !important;
    color: #333 !important;
}

body.light-mode .article-header {
    background-color: #fff !important;
    color: #333 !important;
}

body.light-mode .content {
    background-color: #fff !important;
    color: #333 !important;
}

body.light-mode .content h1,
body.light-mode .content h2,
body.light-mode .content h3,
body.light-mode .content h4,
body.light-mode .content h5,
body.light-mode .content h6 {
    color: #333 !important;
    border-bottom: 1px solid #ccc !important;
}

body.light-mode .content code {
    background-color: #f6f8fa !important;
    border: 1px solid #ddd !important;
    color: #333 !important;
}

body.light-mode pre code {
    background-color: #f6f8fa !important;
    color: #333 !important;
}

body.light-mode .content a {
    color: #80bdff !important;
}

body.light-mode table thead th {
    background-color: #f6f8fa !important;
    border-bottom: 2px solid #ccc !important;
    color: #333 !important;
}

body.light-mode table th,
body.light-mode table td {
    border: 1px solid #ddd !important;
    color: #333 !important;
}

body.light-mode table tbody tr:nth-child(even) {
    background-color: #f9f9f9 !important;
}

body.light-mode table tbody tr:hover {
    background-color: #f0f0f0 !important;
}

body.light-mode .tag {
    background-color: #eee !important;
    color: #333 !important;
}

body.light-mode .tag:hover {
    background-color: #ddd !important;
}

body.light-mode #toc {
    color: #555 !important;
}

body.light-mode #toc a {
    color: #555 !important;
}

body.light-mode #toc a.active {
    background-color: #777 !important;
    color: #fff !important;
}

body.light-mode footer {
    color: #666 !important;
}

/* è–„é’ */
body.light-mode .info {
    background-color: #f0f0f0 !important;
    border-left: 5px solid #80bdff !important;
    color: #333 !important;
}

body.light-mode .warn {
    background-color: #fff3e0 !important;
    border-left: 5px solid #ffa500 !important;
    color: #333 !important;
}

body.light-mode .danger {
    background-color: #ffe7e7 !important;
    border-left: 5px solid #ff4d4f !important;
    color: #333 !important;
}

body.light-mode .theorem,
body.light-mode .lemma,
body.light-mode .corollary,
body.light-mode .proposition,
body.light-mode .definition,
body.light-mode .proof {
    border: 1px solid #ddd !important;
    color: #333 !important;
}

body.light-mode .footnotes {
    border: 1px solid #ddd !important;
    color: #333 !important;
}

body.light-mode .footnote-def {
    border-left: 3px solid #ddd !important;
    color: #333 !important;
}

body.light-mode a {
    color: #80bdff !important;
}

body.light-mode a:hover {
    color: #80bdff !important;
}

body.light-mode .timeline-comment {
    background-color: #fff !important;
    border: 1px solid #ddd !important;
    color: #333 !important;
}

body.light-mode .timeline-comment .timeline-comment-header {
    background-color: #fff !important;
    border-bottom: 1px solid #ddd !important;
    color: #333 !important;
}

body.light-mode .theorem::before,
body.light-mode .lemma::before,
body.light-mode .corollary::before,
body.light-mode .proposition::before,
body.light-mode .definition::before,
body.light-mode .proof::before {
    color: #333 !important;
}


body.light-mode button {
    background-color: #fff !important;
    color: #333 !important;
    /* ãƒã‚¦ã‚¹ã‚ªãƒ¼ãƒãƒ¼æ™‚ã®è‰² */
    border: 1px solid #ddd !important;
    /* ãƒã‚¦ã‚¹ã‚ªãƒ¼ãƒãƒ¼æ™‚ã®ã‚«ãƒ¼ã‚½ãƒ« */
    cursor: pointer;
}</style>

    <!-- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç½®æ›ç”¨ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆå¤‰æ•°ç­‰ -->
    <script>
        page_contents = [];
    </script>

    <!-- Runner is not required. Skip this. -->
</head>

<body>
    <header class="global-header">
        <div class="header-inner">
            <!-- ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ sidebar ã‚’è¡¨ç¤º/éè¡¨ç¤º -->
            <a href="https://abap34.com" class="header-logo">abap34.com</a>
            > <a href="https://abap34.com/blog">/blog</a> > <a href="https://abap34.com/posts/jci_06.html">/Julia Compiler Internals (06) - Implementing Small Julia Compiler</a>
        </div>

        <!-- ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ã¨ãƒ„ã‚¤ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ– -->
        <div class="header-controls" style="display: flex;">
            <!-- ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ -->
            <button id="theme-toggle" aria-label="Toggle Dark Mode">ğŸŒ™</button>
            <!-- ãƒ„ã‚¤ãƒ¼ãƒˆãƒœã‚¿ãƒ³ -->
            <div class="tweet-button">
                <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button"
                    data-text="Julia Compiler Internals (06) - Implementing Small Julia Compiler" data-url="https://abap34.com/posts/jci_06.html" data-via="abap34"> Tweet </a>
                <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
            </div>
        </div>
    </header>


    <div class="article-header">
        <div class="title">Julia Compiler Internals (06) - Implementing Small Julia Compiler</div>
        <script>title = document.querySelector(".title").innerHTML;</script>
        <br>
        <div class="date">2024/02/16</div>
        <br>
        <div class="tag-placeholder">[JuliaCompilerInternals, Julia, ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©, æŸè«–, ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ , æŠ½è±¡è§£é‡ˆ, ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è§£æ]</div>
    </div>

    <!-- 3) ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æœ¬ä½“ (ã‚µã‚¤ãƒ‰ãƒãƒ¼ + ãƒ¡ã‚¤ãƒ³æœ¬æ–‡) -->
    <div class="article-body">

        <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ (TOC) -->
        <div class="side">
            <div class="side-sticky">
                <div class="sidebar">
                    <ul id="toc"></ul>
                </div>
            </div>
        </div>

        <!-- ãƒ¡ã‚¤ãƒ³æœ¬æ–‡ -->
        <div class="content">
            <br><script>page_contents.push({
    "type":"H2",
    "id":"2",
    "title":"ã‚ã‚‰ã™ã˜"
});
</script>
<h2 id="2">ã‚ã‚‰ã™ã˜</h2><br>ä»¥å‰ã¾ã§ç¶šã‘ã¦ã„ãŸ Julia ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã®å†…éƒ¨æ§‹é€ ã«ã¤ã„ã¦ã®è¨˜äº‹ã«ã¤ã„ã¦ã€ä¸€æ—¦ã“ã‚Œã¾ã§ã®çŸ¥è¦‹ã‚’ä½¿ã£ã¦ç°¡ç•¥åŒ–ã—ãŸ Julia ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒ—ãƒ­ã‚»ã‚¹ã‚’å®Ÿè£…ã—ã¾ã™ã€‚<br>ãã®ã»ã‹ã® Juia ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã«é–¢é€£ã™ã‚‹è¨˜äº‹ã¯ <url> <a href="https://www.abap34.com/search?tag=JuliaCompilerInternals">â†’ ã“ã¡ã‚‰</a> </url><br><br><hr><br><br><script>page_contents.push({
    "type":"H2",
    "id":"14",
    "title":"Julia ã¨ å‹æ¨è«–"
});
</script>
<h2 id="14">Julia ã¨ å‹æ¨è«–</h2><br>ã¾ãšæœ€åˆã«ã€(ã¿ã‚“ãªãŒæ€ã„æµ®ã‹ã¹ã‚‹ã‚‚ã®ã¨ã„ã†æ„å‘³ã§) ä¸€èˆ¬çš„ãªå‹æ¨è«–ã¨å°‘ã—é•ã†ã®ã‚‚ã‚ã‚‹ã®ã§ã€Julia ã«ãŠã‘ã‚‹å‹æ¨è«–ã®åˆ©ç”¨ã®ã•ã‚Œæ–¹ã«ã¤ã„ã¦å°‘ã—æ›¸ãã¾ã™ã€‚<br><script>page_contents.push({
    "type":"H3",
    "id":"19",
    "title":"å‹æ¨è«– ?"
});
</script>
<h3 id="19">å‹æ¨è«– ?</h3><br>ã¨ãã«æ„è­˜ã—ã¦è¨˜è¿°ã›ãšã¨ã‚‚ã€ç‰¹å®šã®å¼ãŒå®Ÿè¡Œæ™‚ã«ã¨ã‚Šã†ã‚‹å€¤ã®å‹ã«ã¤ã„ã¦ã„ãã‚‰ã‹ã®éè‡ªæ˜ãªäº‹å®ŸãŒå¸¸ã«æˆã‚Šç«‹ã£ã¦ã„ã‚‹ã“ã¨ã¯ã‚ˆãã‚ã‚Šã¾ã™ã€‚<br><br><div class="code-block"> <pre><code class="language-julia">x = 1  
x + 1 # &lt;- çµ¶å¯¾ `Int`
</code></pre> </div><br>ã®ã‚ˆã†ã«æ›¸ã‘ã°ã€<span class="inline-code"> <code>x + 1</code> </span> ã®å€¤ã¯ <span class="inline-code"> <code>Int</code> </span> ã§ã™ã€‚ <br>ãƒªãƒ†ãƒ©ãƒ«ãŒãªãã¨ã‚‚ã€<br><div class="code-block"> <pre><code class="language-julia">name = readline()         # &lt;- String
msg  = &quot;Hello, $(name)!&quot;  # &lt;- String
</code></pre> </div><br>ã§ã¯ã€<span class="inline-code"> <code>name</code> </span> ã‚‚ <span class="inline-code"> <code>msg</code> </span> ã‚‚ã¤ã­ã« <span class="inline-code"> <code>String</code> </span> ã«ãªã‚‹ã§ã—ã‚‡ã†ã€‚ <br>ã•ã‚‰ã«ã€<br><br><div class="code-block"> <pre><code class="language-julia">if x isa Number              # &lt;- `x` ã®å€¤ã®å‹ã¯ `Number` å‹ã®å­ã‹?
    println(&quot;æ•°å­—:&quot;, x)     
elseif x isa AbstractString  # &lt;- `x` ã®å€¤ã®å‹ã¯ `AbstractString` å‹ã®å­ã‹?
    println(&quot;æ–‡å­—åˆ—:&quot;, x)  
end 
</code></pre> </div><br>ã¨ã„ã†æ¡ä»¶åˆ†å²ã‚’è€ƒãˆã‚‹ã¨ã€ãã‚Œãã‚Œã®æ¡ä»¶åˆ†å²ã®ä¸­ã§ã¯ã€€<ul><li><span class="inline-code"> <code>x</code> </span> ã¯ <span class="inline-code"> <code>Number</code> </span>  (<span class="inline-code"> <code>Int64</code> </span>, <span class="inline-code"> <code>Int32</code> </span>, <span class="inline-code"> <code>Float64</code> </span> ãªã©ã®è¦ª)</li><li><span class="inline-code"> <code>x</code> </span> ã¯ <span class="inline-code"> <code>AbstractString</code> </span> (<span class="inline-code"> <code>String</code> </span>, <span class="inline-code"> <code>LazyString</code> </span> ãªã©ã®è¦ª)</li></ul><br>ã¨ã„ã†äº‹å®ŸãŒå¸¸ã«æˆã‚Šç«‹ã¡ã¾ã™ã€‚<br><br><br>ã“ã®è¨˜äº‹ã§ã¯ <span class="strong"> <strong>Julia ã® Docs ã«ãªã‚‰ã„</strong> </span>ã€ã“ã®ã‚ˆã†ãªäº‹å®Ÿã®å°å‡ºâ”€ ã€Œã‚ã‚‹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ•ãƒ­ãƒ¼ã«ãŠã„ã¦ã‚ã‚‹å¼ãŒå–ã‚Šã†ã‚‹å€¤ã®å‹æƒ…å ±ã‚’é™çš„ã«å°ãã“ã¨ã€ã‚’ <span class="strong"> <strong>å‹æ¨è«– (Type Inference)</strong> </span> ã¨å‘¼ã¶ã“ã¨ã«ã—ã¾ã™ã€‚<br>Julia ã®å‡¦ç†ç³»ã®ç‰¹å¾´ã®ä¸€ã¤ã¯ã€ã“ã®æ„å‘³ã§ã®å‹æ¨è«–ã‚’è¡Œãªã†ã“ã¨ã§ã™ã€‚ ãã—ã¦ã•ã‚‰ã«ç‰¹å¾´çš„ãªç‚¹ã¯ã€å¾—ãŸæƒ…å ±ã‚’ã‚‚ã£ã±ã‚‰ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šã®ãŸã‚ã«ä½¿ã†ã“ã¨ã§ã™ã€‚<br>ã¾ãšã¯å‹æ¨è«–ã«ã‚ˆã£ã¦ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å‘ä¸Šã•ã›ã‚‹ã“ã¨ãŒã§ãã‚‹ä¾‹ã‚’è¦‹ã¦ã¿ã¾ã™ã€‚<br><script>page_contents.push({
    "type":"H4",
    "id":"89",
    "title":"ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šä¾‹: ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã®é™çš„ãªè§£æ±º"
});
</script>
<h4 id="89">ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šä¾‹: ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã®é™çš„ãªè§£æ±º</h4><br>äºŒã¤ã®æ•´æ•°ã‚’å—ã‘å–ã£ã¦ã€ãã®ç·å’Œã‚’è¨ˆç®—ã™ã‚‹é–¢æ•°ã‚’è€ƒãˆã¾ã™ã€‚<br><div class="code-block"> <pre><code class="language-julia">add(a::Int, b::Int) = a + b
</code></pre> </div><br>ã“ã‚Œã‚’ã€ãƒ¦ãƒ¼ã‚¶å®šç¾©å‹ <span class="inline-code"> <code>MyInt</code> </span> ã®çµ„ã«ã‚‚ä½¿ãˆã‚‹ã‚ˆã†ã«ã—ã¦ã¿ã¾ã™ã€‚ ã“ã® <span class="inline-code"> <code>MyInt</code> </span> ã¯åŠ ç®—ã™ã‚‹ã¨ã¤ã„ã§ã« 100å€ã•ã‚Œã¾ã™ã€‚ <span class="footnote-ref"><sup id="ref_scitokyo"><a href="#label_scitokyo">[scitokyo]</a></sup></span><br><br><br><div class="code-block"> <pre><code class="language-julia">struct MyInt
    v::Int
end


add(a::MyInt, b::MyInt) = MyInt((a.v + b.v) * 100)
</code></pre> </div>Julia ã§ã¯ã“ã‚Œã‚‰å„å®Ÿè£…ã®ã“ã¨ã‚’ãƒ¡ã‚½ãƒƒãƒ‰ã¨å‘¼ã³ã¾ã™ã€‚<br>ã¤ã¾ã‚Šã€<span class="inline-code"> <code>add</code> </span> ã¨ã„ã† generic function (ç·ç§°é–¢æ•°) ãŒã‚ã£ã¦ã€<br><ul><li><span class="inline-code"> <code>Int</code> </span> ã‚’æ™®é€šã«è¶³ã™ã‚‚ã®</li><li><span class="inline-code"> <code>MyInt</code> </span> ã‚’100å€ã•ã‚Œã¦è¶³ã™ã‚‚ã®</li></ul><br>ã¨ã„ã† 2ã¤ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚<br>ã“ã®ã¨ãã€Julia ã®å‡¦ç†ç³»ã¯<br><div class="code-block"> <pre><code class="language-julia">a = MyInt(1)
b = MyInt(1)
add(a, b)ã€€# =&gt; MyInt(200)
</code></pre> </div><br>ã®ã‚ˆã†ãªé–¢æ•°å‘¼ã³å‡ºã—ã‚’è¡Œã†éš›ã«ã€ã™ã¹ã¦ã®å¼•æ•°ã®å®Ÿè¡Œæ™‚ã®å€¤ã®å‹ã«åŸºã¥ã„ã¦ <span class="inline-code"> <code>add(a::MyInt, b::MyInt) = MyInt((a.v + b.v) * 100)</code> </span> ã¨ã„ã†å®Ÿè£…ã‚’é¸æŠã—ã¦å®Ÿè¡Œã—ã¦ãã‚Œã¾ã™ã€‚(å¤šé‡ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã¨ã„ã„ã¾ã™)<br>è¤‡æ•°ã®ãƒãƒƒãƒã™ã‚‹å®Ÿè£…ãŒã‚ã‚‹ã¨ãã¯ã€ãã®ã†ã¡ã‚‚ã£ã¨ã‚‚ã€Œç‰¹åŒ–ã—ãŸã‚‚ã®ã€ãŒé¸ã°ã‚Œã¾ã™ã€‚ ä¾‹ãˆã°<br><div class="code-block"> <pre><code class="language-julia">f(x::Real, y::Real) = add_with_error_handle(x, y)
f(x::Int, y::Int) = x + y
</code></pre> </div><br>ã¨ã„ã† <span class="inline-code"> <code>f</code> </span> ãŒã‚ã£ãŸã¨ãã¯ <span class="inline-code"> <code>f(1, 2)</code> </span> ã¨ã„ã†å‘¼ã³å‡ºã—ã¯ä¸‹ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒå‘¼ã³å‡ºã•ã‚Œã¾ã™ã€‚ <span class="inline-code"> <code>(Real, Real)</code> </span> ã¨ã„ã†å‹ã®çµ„ã‚ˆã‚Š <span class="inline-code"> <code>(Int, Int)</code> </span> ã®ã»ã†ãŒã€Œç‰¹åŒ–ã—ã¦ã„ã‚‹å®Ÿè£…ã€ã ã‹ã‚‰ã§ã™ã€‚<br><br>å¤šé‡ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã‚’è¡Œã†ãŸã‚ã«ã¯ å¼•æ•° <span class="inline-code"> <code>a</code> </span>, <span class="inline-code"> <code>b</code> </span> ã®å‹ãŒåˆ¤æ˜ã—ã¦ã„ãªã„ã¨ã„ã‘ãªã„ã‚ã‘ã§ã™ãŒã€Julia ã®å‡¦ç†ç³»ã¯å®Ÿè£…ã®é¸æŠã‚’å®Ÿè¡Œæ™‚ã«è¡Œã†ã“ã¨ã§ã“ã‚Œã‚’å¸¸ã«å¯èƒ½ã«ã—ã¦ã„ã¾ã™ã€‚<br><div class="warn">ã—ã°ã—ã°æ··åŒã•ã‚Œã‚‹æ©Ÿèƒ½ã¨ã—ã¦ã€ä¾‹ãˆã° C++ ãªã©ã«ã‚ã‚‹ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ãŒã‚ã‚Šã¾ã™ãŒã€ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã¯å¤šé‡ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã¨ç•°ãªã‚Šé™çš„ã«å®Ÿè£…ã‚’é¸æŠã—ã¾ã™ã€‚<br>ã¾ãŸ Python ã‚„ Java ã®æ¨™æº–çš„ãª Class ã®ã‚ˆã†ã«å¼•æ•°ã®ã†ã¡ä¸€ã¤ã‚’ç‰¹åˆ¥è¦–ã—ã¦å®Ÿè£…ã‚’é¸æŠ (ã‚·ãƒ³ã‚°ãƒ«ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒ) ã›ãšã«ã€å…¨ã¦ã®å¼•æ•°ã‹ã‚‰å®Ÿè£…ã‚’é¸æŠã™ã‚‹ã®ã‚‚å¤šé‡ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã®ç‰¹å¾´ã§ã™ã€‚</div><br><br>ã•ã¦ã€å¤šé‡ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã«ã‚ˆã‚‹å®Ÿè£…ã®é¸æŠã¯ã€ã‚‚ã®ã™ã”ãã–ã£ãã‚Šæ›¸ã‘ã°ã€<br><div class="code-block"> <pre><code class="language-julia">function call_generic(fname, args)
    argtypes = typeof.(args)                         # (1) å¼•æ•°ã®å€¤ã®å‹ãƒã‚§ãƒƒã‚¯
    matched = lookup(methodtable, fname, argtypes)   # (2) ãƒãƒƒãƒã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æ¤œç´¢
    invoke(matched, args)                            # (3) å®Ÿè¡Œ
end 
</code></pre> </div><br>ã®ã‚ˆã†ãªã“ã¨ã‚’ã—ã¦ã„ã‚‹ã‚ã‘ã§ã™ã€‚<br><br>ã—ã‹ã—ã€ã“ã‚Œã‚’å®Ÿè¡Œæ™‚ã«è¡Œã†ã¨ æ¯å› <span class="inline-code"> <code>typeof.(args)</code> </span> ã‚’å‘¼ã³å‡ºã—ã€ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ãƒ¼ãƒ–ãƒ«ã«æ¤œç´¢ã‚’ã‹ã‘ã‚‹ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚Šã¾ã™ã€‚<br>ã¨ã“ã‚ãŒã©ã£ã“ã„ã€å‹æ¨è«–ã«ã‚ˆã£ã¦ä¾‹ãˆã° ã€Œå¼•æ•°ã¯å…¨ã¦ ã¤ã­ã« <span class="inline-code"> <code>MyInt</code> </span> ã§ã‚ã‚‹ã€ã“ã¨ãªã©ãŒå°ã‘ã‚‹å ´åˆã€ã“ã®å‹ãƒã‚§ãƒƒã‚¯ã¨æ¤œç´¢ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦ã€ç›´æ¥ç‰¹å®šã®ãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã— (ã“ã®å ´åˆã¯ <span class="inline-code"> <code>(a.v + b.v) * 100</code> </span>) ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼<br>ã“ã‚Œã¯å‹æ¨è«–ã«ã‚ˆã£ã¦ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æ”¹å–„ã§ãã‚‹ä»£è¡¨çš„ãªä¾‹ã§ã™ã€‚<br>å®Ÿéš›ã« Julia ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒãã®ã‚ˆã†ãªæœ€é©åŒ–ã‚’è¡Œãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚<br>ä¸‹ã®ã‚ˆã†ãªäºŒã¤ã®é–¢æ•° <span class="inline-code"> <code>f</code> </span>, <span class="inline-code"> <code>g</code> </span> ã‚’è€ƒãˆã¾ã™ã€‚<br><div class="code-block"> <pre><code class="language-julia">julia&gt; a = [1, 2, 3]
3-element Vector{Int64}:
 1
 2
 3

julia&gt; const b = [1, 2, 3]
3-element Vector{Int64}:
 1
 2
 3

julia&gt; function f(c)
           d = c * a
           return sum(d)
       end
f (generic function with 1 method)

julia&gt; function g(c)
           d = c * b
           return sum(d)
       end
g (generic function with 1 method)
</code></pre> </div><br>ã©ã¡ã‚‰ã‚‚ <span class="inline-code"> <code>c * [1, 2, 3]</code> </span> ã®ç·å’Œã‚’è¨ˆç®—ã™ã‚‹é–¢æ•°ã§ã™ãŒã€<span class="inline-code"> <code>[1, 2, 3]</code> </span> ã®å‡ºã©ã“ã‚ãŒ <ul><li><span class="inline-code"> <code>f</code> </span> : ãŸã ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•° </li><li><span class="inline-code"> <code>g</code> </span> : <span class="inline-code"> <code>const</code> </span> å®£è¨€ã—ãŸã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°</li></ul><br>ã¨ã„ã†é•ã„ãŒã‚ã‚Šã¾ã™ã€‚å®Ÿã¯ã€ã“ã®ã“ã¨ã¯å‹æ¨è«–ã‚’ã™ã‚‹ä¸Šã§å¤§ããªå·®ã‚’ç”Ÿã¿ã¾ã™ã€‚<br>ã¨ã„ã†ã®ã‚‚ã€<span class="inline-code"> <code>const</code> </span> å®£è¨€ã•ã‚Œã¦ã„ãªã„ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã¯å¸¸ã«ä»»æ„ã®å‹ã®å€¤ã«æ›¸ãæ›ãˆã‚Œã‚‰ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã®ã§ã€Julia ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¯ãã®å‹ã‚’ <span class="inline-code"> <code>Any</code> </span> ã¨æ¨è«–ã™ã‚‹ã‹ã‚‰ã§ã™ã€‚<br>ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚<br>Julia ã«ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒä½•ã‚’è€ƒãˆã¦ã„ã‚‹ã®ã‹ã‚’èª¿ã¹ã‚‹æ‰‹æ®µãŒãŸãã•ã‚“å‚™ã‚ã£ã¦ãŠã‚Šã€ä¾‹ãˆã° <span class="inline-code"> <code>@code_typed</code> </span> ãƒã‚¯ãƒ­ã‚’ä½¿ã†ã¨å‹æ¨è«–ã®çµæœã‚„ãã‚Œã«åŸºã¥ãæœ€é©åŒ–ã‚’æ–½ã—ãŸçµæœã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚<br><br>ã¾ãš <span class="inline-code"> <code>f(1)</code> </span> ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚<br><div class="code-block"> <pre><code class="language-julia">julia&gt; @code_typed f(1)
# CodeInfo(
# 1 â”€ %1 = Main.a::Any         # &lt;- Any ã¨æ¨è«–ã•ã‚Œã¦ã„ã‚‹
# â”‚   %2 = (c * %1)::Any       # &lt;- ãã‚Œã¨ã®ç©ã¯ `Any` 
# â”‚   %3 = Main.sum(%2)::Any   # &lt;- `sum` ã¨ã„ã† generics å‘¼ã³å‡ºã—ã®ã¾ã¾
# â””â”€â”€      return %3
# ) =&gt; Any                     # &lt;- `f(1)` è‡ªä½“ã‚‚ `Any` ã¨æ¨è«–
</code></pre> </div><br>è¨ˆç®—éç¨‹ã®å¼ã¯å…¨ã¦ <span class="inline-code"> <code>Any</code> </span> ã¨æ¨è«–ã•ã‚Œã¦ã„ã¦ã€è¿”ã‚Šå€¤ã‚‚ <span class="inline-code"> <code>Any</code> </span> ã¨ãªã£ã¦ã„ã¾ã™ã€‚ ã•ã‚‰ã«ã€<span class="inline-code"> <code>sum</code> </span> ã¨ã„ã† generic function ã®å‘¼ã³å‡ºã—ãŒãã®ã¾ã¾æ®‹ã£ã¦ã„ã¾ã™ã­ã€‚<br>ä¸€æ–¹ <span class="inline-code"> <code>g(1)</code> </span> ã¯ (é•·ã„ã®ã§å‡ºåŠ›ã‚’ã‹ãªã‚Šçœç•¥ã—ã¦ã„ã¾ã™ã€‚ãœã²æ‰‹å…ƒã§è©¦ã—ã¦ã¿ã¦ãã ã•ã„)<br><div class="code-block"> <pre><code class="language-julia">julia&gt; @code_typed g(1)
# CodeInfo(
# 1 â”€â”€ %1   = invoke Main.:*(c::Int64, Main.b::Vector{Int64})::Vector{Int64}
#                ...
# 9 â”„â”€ %28  = Base.getfield(%1, :ref)::MemoryRef{Int64}
# â”‚    %29  = Base.memoryrefnew(%28, 1, false)::MemoryRef{Int64}
# â”‚    %30  = Base.memoryrefget(%29, :not_atomic, false)::Int64
# â””â”€â”€â”€        goto #10
# 10 â”€        goto #32
# 11 â”€ %33  = Base.slt_int(%8, 16)::Bool
# â””â”€â”€â”€        goto #31 if not %33
#               ...
# 31 â”€ %98  = invoke Base.mapreduce_impl(%4::typeof(identity),  %5::typeof(Base.add_sum), %1::Vector{Int64}, 1::Int64, %8::Int64, 1024::Int64)::Int64
# â””â”€â”€â”€        goto #32
# 32 â”„ %100 = Ï† (#3 =&gt; 0, #10 =&gt; %30, #30 =&gt; %72, #31 =&gt; %98)::Int64
#                ...
# â”‚    %118 = Base.not_int(%117)::Bool
# â””â”€â”€â”€        goto #46 if not %118
# 45 â”€        goto #2
# 46 â”€        return %110
# ) =&gt; Int64
</code></pre> </div><br>è¿”ã‚Šå€¤ã¯ <span class="inline-code"> <code>Int64</code> </span> ã¨æ¨è«–ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã€ãã—ã¦ <span class="inline-code"> <code>sum</code> </span> ã®å‘¼ã³å‡ºã—ã¯æ¶ˆãˆã¦å…·ä½“çš„ãªå®Ÿè£…ã«ç½®ãæ›ãˆã‚‰ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã•ã‚‰ã«ã‚ˆãè¦‹ã‚‹ã¨ã€<span class="inline-code"> <code>slt_int</code> </span> ã®ã‚ˆã†ãª <span class="inline-code"> <code>Int</code> </span> å‘ã‘ã®ç‰¹åŒ–ã—ãŸé–¢æ•°ãŒä½¿ã‚ã‚Œã¦ã„ã‚‹ã®ãŒã‚ã‹ã‚‹ã¨æ€ã„ã¾ã™ã€‚<br><br>å®Ÿè¡Œé€Ÿåº¦ã‚’èª¿ã¹ã‚‹ã¨<br><div class="code-block"> <pre><code class="language-julia">julia&gt; @benchmark f(1)
BenchmarkTools.Trial: 10000 samples with 994 evaluations per sample.
 Range (min â€¦ max):  30.978 ns â€¦  2.146 Î¼s  â”Š GC (min â€¦ max): 0.00% â€¦ 97.90%
 Time  (median):     33.284 ns              â”Š GC (median):    0.00%
 Time  (mean Â± Ïƒ):   36.100 ns Â± 46.637 ns  â”Š GC (mean Â± Ïƒ):  7.44% Â±  6.10%

  â–â–‚â–â–â–‡â–‡â–…â–ƒâ–‚â–…â–ˆâ–ˆâ–„â–ƒâ–…â–ƒâ–‚â– â–â–ƒâ–ƒâ–                                     â–‚
  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–†â–‡â–‡â–†â–†â–…â–…â–†â–…â–†â–†â–‚â–…â–…â–…â–…â–†â–‡â–„â–…â–†â–…â–…â–…â–„â–…â–…â–„â–…â–…â–…â–† â–ˆ
  31 ns        Histogram: log(frequency) by time        44 ns &lt;

 Memory estimate: 80 bytes, allocs estimate: 2.

julia&gt; @benchmark g(1)
BenchmarkTools.Trial: 10000 samples with 998 evaluations per sample.
 Range (min â€¦ max):  15.281 ns â€¦  1.825 Î¼s  â”Š GC (min â€¦ max):  0.00% â€¦ 98.33%
 Time  (median):     15.949 ns              â”Š GC (median):     0.00%
 Time  (mean Â± Ïƒ):   18.962 ns Â± 52.555 ns  â”Š GC (mean Â± Ïƒ):  13.34% Â±  4.96%

   â–„â–†â–†â–ˆâ–ˆâ–‡â–†â–…â–„â–„â–‚â–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â– â– â–â–â–‚â–â– â–    â–â–‚â–â–                       â–‚
  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–†â–‡â–‡â–†â–…â–…â–†â–…â–†â–†â–†â–…â–…â–†â–…â–†â–ƒâ–†â–‡â–‡ â–ˆ
  15.3 ns      Histogram: log(frequency) by time        22 ns &lt;

 Memory estimate: 80 bytes, allocs estimate: 2.

</code></pre> </div><br>ã¨ã€<span class="inline-code"> <code>g(1)</code> </span> ã®æ–¹ãŒ 2 å€è¿‘ãé«˜é€Ÿã§ã™ï¼<br>ã“ã†ã—ã¦ Julia è¨€èªã¯å‹æ¨è«–ã«åŸºã¥ãæœ€é©åŒ–ã§è‰¯å¥½ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å¾—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚<br>ã“ã®ã‚ˆã†ãªä¾‹ã‚’å‡ºã™ã¨ã€ŒJulia ã§ã¯ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å‡ºã™ã«ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã®æ°—æŒã¡ã‚’ç†è§£ã—ãªã‘ã‚Œã°ã„ã‘ãªã„ã®ã‹ã€ã¨ãªã‚‹ã‹ã‚‚çŸ¥ã‚Œã¾ã›ã‚“ãŒã€Julia ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¯å¤§å¤‰è³¢ãã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®ãŸã‚ã«æ°—ã‚’ã¤ã‘ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã¯ (å°‘ãªãã¨ã‚‚åŒã˜ã‚ˆã†ãªã€Œç°¡æ½”ã ã‘ã©é«˜é€Ÿã€ã¨ã„ã†å£²ã‚Šè¾¼ã¿ã®è¨€èªã«æ¯”ã¹ã‚Œã°) ã‹ãªã‚Šå°‘ãªã„ã¨ã„ã†ã®ãŒç§ã®å°è±¡ã§ã™ã€‚<br><script>page_contents.push({
    "type":"H4",
    "id":"262",
    "title":"ãã®ã»ã‹ã®ç‰¹å¾´"
});
</script>
<h4 id="262">ãã®ã»ã‹ã®ç‰¹å¾´</h4><br>Julia ã®å‹æ¨è«–ãƒ—ãƒ­ã‚»ã‚¹ãŒæŒã¤ç‰¹å¾´ã¨ã—ã¦ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚<br><script>page_contents.push({
    "type":"H5",
    "id":"267",
    "title":"1 æ¨è«–ã¯ <span class="strong"> <strong>ã§ãã‚‹é™ã‚Š</strong> </span> è¡Œã‚ã‚Œã‚‹"
});
</script>
<h5 id="267">1 æ¨è«–ã¯ <span class="strong"> <strong>ã§ãã‚‹é™ã‚Š</strong> </span> è¡Œã‚ã‚Œã‚‹</h5><br>Julia ã®å‡¦ç†ç³»ã¯æ¨è«–ç²¾åº¦ (ã«ã‚ˆã‚‹å®Ÿè¡Œæ™‚é–“ã®çŸ­ç¸®) ã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚é–“ã¨ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã«æ°—ã‚’ä½¿ã£ã¦å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚<br>ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«è¡Œã„ãŸã„ç§‘å­¦æŠ€è¡“è¨ˆç®—ã§ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚é–“ãŒã„ãŸãšã‚‰ã«é•·ããªã‚‹ã‚ˆã†ãªå‡¦ç†ç³»ã®ä½“é¨“ã¯ã¨ã¦ã‚‚æ‚ªããªã‚‹ã‹ã‚‰ã§ã™ã€‚<br>ç†è«–çš„ã«é”æˆã§ãã‚‹é™ç•Œã¾ã§ç²¾åº¦ã‚ˆãæ¨è«–ã§ããªãã¦ã‚‚å®Ÿè¡Œè‡ªä½“ã¯ã§ãã‚‹ã®ã§ã€å®Ÿã¯å°å‡ºå¯èƒ½ã§ã‚ã£ã¦ã‚‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚é–“ã®çŸ­ç¸®ã®ãŸã‚æ¨è«–ã‚’è¡Œã‚ãªã„ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚<br><br><script>page_contents.push({
    "type":"H5",
    "id":"280",
    "title":"2 æ¨è«–ã®ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã¯é–¢æ•°å‘¼ã³å‡ºã—"
});
</script>
<h5 id="280">2 æ¨è«–ã®ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã¯é–¢æ•°å‘¼ã³å‡ºã—</h5><br>Julia ã®é–¢æ•°ã¯ã‚ãŸã‚‰ã—ã„å¼•æ•°ã®å‹ã®çµ„ã§å‘¼ã³å‡ºã•ã‚ŒãŸã¾ã•ã«ãã®ã¨ãã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã€å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚ ãã®ãŸã‚ã€Julia ã®å‹æ¨è«–ãƒ—ãƒ­ã‚»ã‚¹ã¯ã€æ¸¡ã•ã‚ŒãŸå…·ä½“çš„ãªå€¤ã®å‹ã‹ã‚‰å‡ºç™ºã—ã¾ã™ã€‚<br><script>page_contents.push({
    "type":"H5",
    "id":"285",
    "title":"3 æ¨è«–ã¯ inter-procedural ã«è¡Œã‚ã‚Œã‚‹"
});
</script>
<h5 id="285">3 æ¨è«–ã¯ inter-procedural ã«è¡Œã‚ã‚Œã‚‹</h5><br><br>Julia ã®å‹æ¨è«–ã¯é–¢æ•°å¢ƒç•Œã‚’è·¨ã„ã§è¡Œã‚ã‚Œã¾ã™ã€‚ã¤ã¾ã‚Šã€ãƒ“ãƒ«ãƒˆã‚¤ãƒ³é–¢æ•°ã¨ã¯é™ã‚‰ãªã„ (= è¿”ã‚Šå€¤ã®å‹ãŒæ˜ã‚‰ã‹ã§ãªã„) <span class="inline-code"> <code>g</code> </span> ã®å‘¼ã³å‡ºã—ã‚’å«ã‚€ <span class="inline-code"> <code>f</code> </span> ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹éš›ã€<span class="inline-code"> <code>g</code> </span> ã«å¯¾ã™ã‚‹æ¨è«–ã‚‚è¡Œã‚ã‚Œã¾ã™ã€‚<br>ã¾ã¨ã‚ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚<br><div class="info"><span class="strong"> <strong>Julia ã®å‹æ¨è«–ãƒ—ãƒ­ã‚»ã‚¹ã®ã¾ã¨ã‚</strong> </span><br><br>Julia ã®å‹æ¨è«–ãƒ—ãƒ­ã‚»ã‚¹ã¯<br><ol><li>é–¢æ•°ã®å®Ÿéš›ã®å®Ÿè¡Œã‚’å§‹ã‚ã‚ˆã†ã¨ã™ã‚‹ <span class="strong"> <strong>ã¾ã•ã«ãã®ã¨ãã«</strong> </span></li><li>ãã®å¼•æ•°ã® <span class="strong"> <strong>å€¤ã®å‹</strong> </span> ã‹ã‚‰</li><li>ã‚ã‚‹ç®‡æ‰€ã§ã®å¤‰æ•°ã®å‹ã®æƒ…å ±ã‚’ </li><li><span class="strong"> <strong>é–¢æ•°å¢ƒç•Œã‚’è·¨ã„ã§</strong> </span> å†å¸°çš„ã«</li><li><span class="strong"> <strong>ã§ãã‚‹é™ã‚Š</strong> </span>æ¨è«–ã™ã‚‹ ã“ã¨</li><li>(ã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å‘ä¸Šã•ã›ã‚‹)</li></ol><br>ãƒ—ãƒ­ã‚»ã‚¹ã€‚</div><br>ã¾ãŸã€å¾—ã‚‰ã‚Œã‚‹å‹æƒ…å ±ã®åˆ©ç”¨ã®ã•ã‚Œæ–¹ã‚‚ä¸€èˆ¬çš„ãªé™çš„å‹ä»˜ã‘è¨€èªã¨ã¯ã‹ãªã‚Šç•°ãªã‚Šã¾ã™ã€‚<br>Julia ã¯ JIT ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«<span class="footnote-ref"><sup id="ref_jitcompile"><a href="#label_jitcompile">[jitcompile]</a></sup></span> ã§å‹•ä½œã™ã‚‹å‹•çš„å‹ä»˜ã‘ã®è¨€èªã§ã™ã€‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«å‹æ¤œæŸ»ã¯è¡Œã‚ã‚Œãšã€ä¾‹ãˆã°ãƒ¡ã‚½ãƒƒãƒ‰ãŒå­˜åœ¨ã—ãªã„ã“ã¨ãŒã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«ã‚ã‹ã£ã¦ã‚‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ãªã©ã¨ã¯ã›ãšã€å®Ÿè¡Œæ™‚ä¾‹å¤–ã«ãªã‚Šã¾ã™ã€‚<br><br><div class="code-block"> <pre><code class="language-no_method.jl">myadd(a::Int, b::Int) = a + b

function main()
    println(&quot;Start to execute main~~&quot;)
    myadd(0.2, 0.3)  # &lt;- `myadd` ã¯ (Float64, Float64) ã«å¯¾ã—ã¦ã¯å®Ÿè£…ãŒãªã„
end

main()

# â†“
# â†“
# julia&gt; include(&quot;no_method.jl&quot;)
# Start to execute main~~
# ERROR: LoadError: MethodError: no method matching myadd(::Float64, ::Float64)
# The function `myadd` exists, but no method is defined for this combination of argument types.
# 
# Closest candidates are:
#   myadd(::Int64, ::Int64)
#    @ Main ~/Desktop/mu/no_method.jl:1
</code></pre> </div><br><br>ãã®æ„å‘³ã§ã€ã“ã¨ Julia ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©æœ¬ä½“ã«ãŠã„ã¦ã¯å‹æ¨è«–ã¯ã»ã¨ã‚“ã©ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®ãŸã‚ã®ã„ã¡æƒ…å ±ã«éããªã„ã‚ã‘ã§ã™ãŒã€æœ¬ä½“ã«ãªã„ã ã‘ã§ Julia ã®å‹æ¨è«–ã‚’ä½¿ã£ã¦é™çš„ã«ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯ã‚’ã—ãŸã‚Šã€rutime-dispatch ãªã©ã‚’æ¤œçŸ¥ã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãªã©ã‚‚ã‚ã‚Šã¾ã™ã€‚<br>ã“ã“ã§ã¯ JET.jl ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚<br>https://github.com/aviatesk/JET.jl<br><div class="code-block"> <pre><code class="language-julia">julia&gt; using JET

julia&gt; myadd(a::Int, b::Int) = a + b
myadd (generic function with 1 method)

julia&gt; function main()
           println(&quot;Start to execute main~~&quot;)
           myadd(0.2, 0.3)  
       end
main (generic function with 1 method)

julia&gt; @report_call main()
â•â•â•â•â• 1 possible error found â•â•â•â•â•         # &lt;-  no method ã‚’ç™ºè¦‹
â”Œ main() @ Main ./REPL[3]:3
â”‚ no matching method found `myadd(::Float64, ::Float64)`: myadd(0.2, 0.3)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</code></pre> </div><br>JET.jl ã¯ã€Julia ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã®å‹æ¨è«–ãƒ—ãƒ­ã‚»ã‚¹ã‚’åˆ©ç”¨ã—ã¦ã€ä¸Šã®ã‚ˆã†ã« <span class="inline-code"> <code>main</code> </span> ã®å‘¼ã³å‡ºã—ã§ <span class="inline-code"> <code>(Float64, Float64)</code> </span> ã«å¯¾ã™ã‚‹ <span class="inline-code"> <code>myadd</code> </span> ã®å®Ÿè£…ãŒã‚ã‚‹ã‹ã‚’é™çš„ã«æ¤œæŸ»ã—ã¦ãã‚Œã¾ã™ã€‚<br>ã¾ãŸã€ã“ã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã®çµ„ã¿è¾¼ã¿ã¯ã¾ã ç™ºå±•é€”ä¸Šã§ã™ã¨ã„ã†ã®ãŒæ­£ç›´ãªç­”ãˆã«ãªã£ã¦ã—ã¾ã†ã‚‚ã®ã®ã€Language Server ã‚‚ä¸€å¿œã‚ã‚Šã¾ã™ã€‚<br>https://github.com/julia-vscode/LanguageServer.jl<br><br>Julia ã®å‹ã‚·ã‚¹ãƒ†ãƒ ãã®ã‚‚ã®ã«ã¤ã„ã¦ã®è©³ã—ã„è§£èª¬ã¯ (30 è¨˜äº‹ãã‚‰ã„ã«ãªã£ã¦ã—ã¾ã†ã®ã§) ã“ã“ã§ã¯æ·±ãã¯è§¦ã‚Œã¾ã›ã‚“ã€‚<br><url> <a href="https://docs.julialang.org/en/v1/manual/types/">å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆâ”€ types</a> </url> ã‹ã€ã‚ã‚‹ã„ã¯æ—¥æœ¬èªã®æ›¸ç±ã‚‚ã„ãã¤ã‹ã‚ã£ã¦ãã®ä¸­ã§ã‚ã‚‹ç¨‹åº¦è§£èª¬ã•ã‚Œã¦ã„ã‚‹ã®ã§ãã¡ã‚‰ã‚’å‚ç…§ã—ã¦ã¿ã¦ãã ã•ã„ã€‚ å‹ã‚·ã‚¹ãƒ†ãƒ é–¢é€£ã ã¨ã¨ãã«å®Ÿè·µ Juliaå…¥é–€ã¯ç›¸å½“è©³ã—ãæ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚<br><ul><li><url> <a href="https://amzn.asia/d/2TAXhJK">å®Ÿè·µ Juliaå…¥é–€</a> </url></li><li><url> <a href="https://amzn.asia/d/4JX6MR2">Julia ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°å¤§å…¨</a> </url></li><li><url> <a href="https://amzn.asia/d/cqUjZ7p">1ã‹ã‚‰å§‹ã‚ã‚‹ Juliaãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°</a> </url></li></ul><br><script>page_contents.push({
    "type":"H3",
    "id":"378",
    "title":"Julia ã®å‹æ¨è«–ã¾ã§ã®ãƒ—ãƒ­ã‚»ã‚¹"
});
</script>
<h3 id="378">Julia ã®å‹æ¨è«–ã¾ã§ã®ãƒ—ãƒ­ã‚»ã‚¹</h3><br>ã•ã¦ã€ã“ã“ã‹ã‚‰ã¯ã“ã®å‹æ¨è«–ãƒ—ãƒ­ã‚»ã‚¹ã‚’ä½œã£ã¦ã„ãã¾ã™ã€‚<br>ã¾ãšã¯å®Ÿè£…ã‚’å§‹ã‚ã‚‹å‰ã«ã€å‹æ¨è«–ãƒ—ãƒ­ã‚»ã‚¹ã®å…¥å‡ºåŠ›ã‚’æ˜ç¢ºã«ã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚<br><figure><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3929241/56511b86-333b-c441-f8b4-36b4704a3cd1.png" ><figcaption>image.png</figcaption></figure><br>ã¾ãšã€Julia ã®å‡¦ç†ç³»ã¯ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦ (surface-) AST ã‚’ä½œã‚Šã¾ã™ã€‚<br>ã—ã‹ã—ã€AST ã¯ãã®ã¾ã¾ã ã¨æœ€é©åŒ–ãŒå®Ÿè£…ã—ã«ãã„ã®ã§ã€Julia ã®å‹æ¨è«–ã¯ AST ã‚’æœ€é©åŒ–ã—ã‚„ã™ã„ã‚ˆã†å¤‰å½¢ã—ãŸ IR ã«å¯¾ã—ã¦è¡Œã‚ã‚Œã¾ã™ã€‚(ã“ã®å‡¦ç†ã¯ lowering ã¨å‘¼ã°ã‚Œã¾ã™)<br>å®Ÿéš›ã«ã¯ã•ã¾ã–ã¾ãªã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¸ã®ãƒ’ãƒ³ãƒˆãªã©ã‚‚å«ã¿ã¾ã™ãŒã€ä½¿ã‚ã‚Œã‚‹ IR ã¯ã–ã£ãã‚Šè¨€ã£ã¦ã—ã¾ãˆã°<br><ul><li>ãƒã‚¯ãƒ­ãŒå…¨ã¦å±•é–‹ã•ã‚Œã¦</li><li>å…¨ã¦ã®ç³–è¡£æ§‹æ–‡ (for, ä¸‰é …æ¼”ç®—å­ãªã©) ãŒè§£ä½“ã•ã‚Œã¦</li><li>GOTO ã‚’ä½¿ã£ãŸç›´åˆ—ã®å‘½ä»¤åˆ—ã¸ã®æ›¸ãç›´ã— (linearize) ãŒè¡Œã‚ã‚ŒãŸ</li></ul><br>å½¢å¼ã§ã™ã€‚<br><span class="inline-code"> <code>Meta.lower</code> </span> ã«ã‚ˆã£ã¦å®Ÿéš›ã« AST ã‹ã‚‰ IR ã«å¤‰æ›ã—ãŸçµæœã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã‚‹ã®ã§ã™ãŒã€<br><div class="code-block"> <pre><code class="language-julia">julia&gt; lowered_ir = Meta.lower(Main, 
                  quote
                      for i in 1:10
                          println(i)
                      end
                  end
              )
              
# :($(Expr(:thunk, CodeInfo(
#    @ REPL[23]:3 within `top-level scope`
# 1 â”€ %1  = :
# â”‚   %2  = (%1)(1, 10)
# â”‚         #s2 = Base.iterate(%2)         
# â”‚   %4  = #s2
# â”‚   %5  = %4 === nothing
# â”‚   %6  = Base.not_int(%5)
# â””â”€â”€       goto #4 if not %6                # &lt;- goto ãŒç”Ÿãˆã¦ã‚‹
# 2 â”„ %8  = #s2
# â”‚         i = Core.getfield(%8, 1)
# â”‚   %10 = Core.getfield(%8, 2)
# â”‚   @ REPL[23]:4 within `top-level scope`
# â”‚   %11 = i
# â”‚         println(%11)
# â”‚   @ REPL[23]:5 within `top-level scope`
# â”‚         #s2 = Base.iterate(%2, %10)
# â”‚   %14 = #s2
# â”‚   %15 = %14 === nothing
# â”‚   %16 = Base.not_int(%15)
# â””â”€â”€       goto #4 if not %16                # &lt;- goto ãŒç”Ÿãˆã¦ã‚‹
# 3 â”€       goto #2                           # &lt;- goto ãŒç”Ÿãˆã¦ã‚‹
# 4 â”„       return nothing
# ))))
</code></pre> </div><br>ãªã‚“ã ã‹ã”ã¡ã‚ƒã”ã¡ã‚ƒã—ã¦ã„ã‚‹ã‚ˆã†ã«è¦‹ãˆã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€for æ–‡ãŒè§£ä½“ã•ã‚Œã¦æ¡ä»¶ä»˜ã goto ã‚’ä½¿ã£ãŸç›´åˆ—ã®å‘½ä»¤åˆ—ã¸ã®æ›¸ãæ›ãˆãŒã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚<br><br>ã“ã®ã‚ˆã†ãª IR ã‚‚ Julia è‡ªä½“ã§ã®è¡¨ç¾ (<span class="inline-code"> <code>CodeInfo</code> </span> å‹) ã‚’æŒã¤ã®ã§ã€è§¦ã£ã¦éŠã¶ã“ã¨ãŒã§ãã¾ã™ã€‚<br><div class="code-block"> <pre><code class="language-julia">julia&gt; lowered_ir.args[1].code[1:10]
10-element Vector{Any}:
 :(Core.get_binding_type(Main, :i))
 :(_1 = 0)
 :(_1)
 :(%3 isa %1)
 :(goto %7 if not %4)
 :(goto %9)
 :(_1)
 :(_1 = Base.convert(%1, %7))
 :(_1)
 :(i = %9)
</code></pre> </div><br>ä¸€æ–¹ã§ lowering ã®å‡¦ç†ãã‚Œè‡ªä½“ã¯ç¾åœ¨ã¯ C ã‚„ Scheme ã§å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã®ã§ã™ãŒã€æœ€è¿‘ã¯ Julia ã«ã‚ˆã£ã¦æ›¸ãç›´ã™ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒé€²ã‚“ã§ãŠã‚Šã€ã„ãšã‚Œã¯ Julia ã§å®Œçµã™ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚(ãƒ‘ãƒ¼ã‚µã‚‚ã‹ã¤ã¦ã¯ Scheme è£½ã§ã—ãŸãŒä»Šã¯ Juliaè£½ã®ã‚‚ã®ãŒå‹•ã„ã¦ã„ã¾ã™ã€‚https://github.com/JuliaLang/JuliaSyntax.jl)<br>https://github.com/c42f/JuliaLowering.jl<br>ã“ã® lowerd IR ã‚’å—ã‘å–ã‚Šã€å‹æƒ…å ±ã‚’ä»˜åŠ ã—ãŸã‚‚ã®ã‚’å‡ºåŠ›ã™ã‚‹ã®ãŒç›®æ¨™ã§ã™ã€‚<br><figure><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3929241/d8118ab4-c178-42f4-a5e4-96314a86dac5.png" ><figcaption>image.png</figcaption></figure><br><br><br><script>page_contents.push({
    "type":"H3",
    "id":"427",
    "title":"Julia ã®å‹æ¨è«–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã€€â”€ æŠ½è±¡è§£é‡ˆ"
});
</script>
<h3 id="427">Julia ã®å‹æ¨è«–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã€€â”€ æŠ½è±¡è§£é‡ˆ</h3><br>Julia ã®å‹æ¨è«–ã¯ã€æŠ½è±¡è§£é‡ˆã¨ã„ã†æ çµ„ã¿ã®ã‚‚ã¨æ§‹ç¯‰ã•ã‚Œã¦ã„ã¾ã™ã€‚<br>æœ€åˆã«ã‚‚æ›¸ãã¾ã—ãŸãŒã€ã“ã‚Œã‚’æ­£ç¢ºã«èª¬æ˜ã™ã‚‹ã“ã¨ã«ã™ã‚‹ã¨å¤§å¤‰ãªãƒœãƒªãƒ¥ãƒ¼ãƒ ã«ãªã£ã¦ã—ã¾ã†ã®ã§ã€è©³ã—ã„è©±ã¯ <url> <a href="https://www.abap34.com/search?tag=%E3%83%87%E3%83%BC%E3%82%BF%E3%83%95%E3%83%AD%E3%83%BC%E8%A7%A3%E6%9E%90">abap34.com/search?tag=ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è§£æ</a> </url> ã«è­²ã‚Šã€ã“ã“ã§ã¯ã‹ãªã‚Šç°¡å˜ãªå†…å®¹ã«ç•™ã‚ã¾ã™ã€‚<br>æŠ½è±¡è§£é‡ˆã¯ã€ç°¡å˜ã«è¨€ãˆã°<br><span class="strong"> <strong>ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å…·ä½“çš„ãªå€¤ã‚’å°‘ã—æŠ½è±¡åŒ–ã—ã¦ã€Œè©•ä¾¡ã€ã™ã‚‹æ çµ„ã¿</strong> </span><br><br>ã®ã“ã¨ã§ã™ã€‚ä¾‹ãˆã° <br><ul><li>ç¾ã‚Œã‚‹ã®ã¯ã™ã¹ã¦è‡ªç„¶æ•°</li><li>æ¼”ç®—ã¯æ›ã‘ç®—ã ã‘</li></ul><br>ã¨ã„ã†è¨€èªã§ã€<br><div class="code-block"> <pre><code class="language-julia">if cond
    x = 1
else
    x = 2
end

y = 2 * x

y 
</code></pre> </div><br>ã¨ã„ã†ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒã‚ã£ãŸã¨ã—ã¾ã™ã€‚ ã“ã®ã¨ãã€ã‚ã‚‹å¤‰æ•°ãŒã‚ã‚‹å‘½ä»¤ã®å®Ÿè¡Œç›´å‰,ç›´å¾Œã« å¶æ•°ã§ã‚ã‚‹ã‹ï¼Ÿ å¥‡æ•°ã§ã‚ã‚‹ã‹ï¼Ÿã¨ã„ã†ã®ã‚’è§£æã™ã‚‹ã“ã¨ã‚’è€ƒãˆã¦ã¿ã¾ã™ã€‚<br>æŠ½è±¡è§£é‡ˆã¯ã€å…ƒã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å¤‰æ•°ã‚’ä¾‹ãˆã° ã€Œå¶æ•°ã‹å¥‡æ•°ã€ã€Œå¶æ•°ã€ã€Œå¥‡æ•°ã€ã€Œæœªå®šç¾©ã€ã¨ã„ã†ã‚ˆã†ãªæŠ½è±¡çŠ¶æ…‹ã«å‰²ã‚Šå½“ã¦ã‚‹ã“ã¨ã«ã‚ˆã£ã¦è¡Œã„ã¾ã™ã€‚<br>ã¤ã¾ã‚Šä¸Šã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’<br><div class="code-block"> <pre><code class="language-julia">x? &lt;= æœªå®šç¾©
y? &lt;= æœªå®šç¾©

if cond
    x = å¥‡æ•°
else
    x = å¶æ•°
end

x? &lt;= (å¥‡æ•° ã¾ãŸã¯ å¶æ•°)

y = å¶æ•° * (å¥‡æ•° ã¾ãŸã¯ å¶æ•°)

y? &lt;=  å¶æ•°
</code></pre> </div><br>ã¨ã„ã†ã‚ˆã†ã«è©•ä¾¡ã™ã‚‹ã‚ã‘ã§ã™ã€‚ (ã“ã“ã§ã€ã€Œå®Ÿè¡Œã€ã¨ã„ã†è¨€è‘‰ã‚’ä½¿ã‚ãªã‹ã£ãŸã®ã¯ã€ã‚‚ã¨ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¨åŒã˜é †åºã§åˆ¶å¾¡ãƒ•ãƒ­ãƒ¼ã‚’è¾¿ã£ã¦è©•ä¾¡ã™ã‚‹ã¨ã¯é™ã‚‰ãªã„ã‹ã‚‰ã§ã™)<br>ãã—ã¦ã€ã“ã®è©•ä¾¡ã¯<br><ol><li>ãƒªãƒ†ãƒ©ãƒ«ã®ä»£å…¥ã¯ (å…ƒã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®) å³è¾ºã®å€¤ã®å¶å¥‡ãŒå…¥ã‚‹</li><li>æ›ã‘ç®—ã®ä»£å…¥ã¯ (å¥‡æ•°) <span class="italic"> <i> (å¥‡æ•°) ã¯å¥‡æ•°, (å¥‡æ•°) </i> </span> (å¶æ•°) ã¯å¶æ•°, ...</li></ol><br>ã¨ã„ã†æŠ½è±¡åŒ–ã—ãŸã‚‚ã¨ã§ã®æ„å‘³é–¢æ•°ã‚’å®šã‚ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã§ãã¾ã™ã€‚<br><br>ã•ã‚‰ã«ã€æŠ½è±¡çŠ¶æ…‹ã®é–“ã«ã¯å–ã‚Šã†ã‚‹å€¤ã®åŒ…å«é–¢ä¿‚ã€ã¤ã¾ã‚Šã€Œå…·ä½“åº¦ã€ã€Œæƒ…å ±é‡ã€ã¨æ‰ãˆã‚‰ã‚Œã‚‹é †åºãŒå®šã‚ã‚‰ã‚Œã¾ã™ã€‚<br>ä»Šå›ã¯ ã€Œæœªå®šç¾©ã€ <span class="math-inline"> \( \leq \) </span> ã€Œå¶æ•°ã€ <span class="math-inline"> \( = \) </span> ã€Œå¥‡æ•°ã€ <span class="math-inline"> \( \leq \) </span>ã€Œå¶æ•°ã¾ãŸã¯å¥‡æ•°ã€ ã¨ã„ã†æ„Ÿã˜ã§ã—ã‚‡ã†ã‹ã€‚<br><br><figure><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3929241/819ab0a4-5d78-4f22-8caa-df8a0536ea40.png" ><figcaption>image.png</figcaption></figure><br><br><br><br><br>ã“ã®ã‚‚ã¨ã§ã€ãªã‚‹ã¹ãå…·ä½“çš„ãªã‚‚ã®ã‚’æ±‚ã‚ã¾ã—ã‚‡ã†. ã¨ã„ã†å½¢ã«å®šå¼åŒ–ã™ã‚‹ã“ã¨ã§ã€ã§ãã‚‹ç¯„å›²ã§æ­£ç¢ºãªé™çš„è§£æã‚’è¡Œã†ã‚ˆã†ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’è€ƒãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚<br><br>ã•ã¦ã€ã“ã® å¶æ•° or å¥‡æ•°? ã¨ã„ã†ã®ã‚’å‹ã£ã½ã„ã‚‚ã®ã«ç½®ãæ›ãˆã‚Œã°å‹ã®é™çš„ãªè§£æãŒã§ããã†ãªã®ã¯ä½•ã¨ãªãç†è§£ã§ãã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚<br>ãªã®ã§å•é¡Œã¯<br><ul><li>ã“ã®ã‚ˆã†ãªæŠ½è±¡çš„ãªè©•ä¾¡ã¯ã©ã®ãã‚‰ã„ã¾ã§ãªã‚‰è©³ã—ãã§ãã‚‹ã®ã‹ ?</li><li>å‹ãƒ¬ãƒ™ãƒ«ã«æŠ½è±¡åŒ–ã—ãŸè©•ä¾¡ã€ã¨ã„ã†ã‚‚ã®ã¯å‡ºæ¥ã‚‹ã‚‚ã®ã«å«ã¾ã‚Œã‚‹ã®ã‹ ï¼Ÿ</li></ul><br>ã«ãªã‚Šã¾ã™ã€‚<br>(ä¾‹ãˆã°å…·ä½“çš„ãªå€¤ã¨å®Œå…¨ã«å¯¾å¿œã•ã›ã‚Œã°ãã‚Œã¯ãŸã ã®å…·ä½“çš„ãªå®Ÿè¡Œã§ã™ãŒã€ã“ã‚Œã¯å½“ç„¶åœæ­¢ã—ãªã„ã“ã¨ã‚‚ã‚ã‚Šã¾ã™)<br><br>ãã“ã§ã“ã®ãã‚‰ã„ãªã‚‰è§£ã‘ã¾ã™ã‚ˆ. ã¨ã„ã†ã®ãŒè€ƒãˆã‚‰ã‚Œã¦ã„ã¾ã™ã€‚<br>å…ˆã»ã©ã‚‚æ›¸ã„ãŸã‚ˆã†ã«ã“ã“ã§ãã®è©±ã‚’å±•é–‹ã™ã‚‹ã¨åŒäººèªŒã«ãªã£ã¦ã—ã¾ã†ã®ã§ã€æ°—ã«ãªã‚‹æ–¹ã¯ä¸Šã®ãƒªãƒ³ã‚¯ã‚’è¸ã‚“ã§ã‚‚ã‚‰ãˆã‚Œã°ã¨æ€ã„ã¾ã™ã€‚<br>ã“ã“ã§ã¯ä»Šå›åˆ©ç”¨ã™ã‚‹çµæœã ã‘ã‚’ç°¡å˜ã«è¿°ã¹ã¾ã™ã€‚<br>æŠ½è±¡è§£é‡ˆã®æ çµ„ã¿ã§ã€ã€Œã‚ã‚‹å‘½ä»¤ã®å®Ÿè¡Œå‰å¾Œã§ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®æŠ½è±¡çŠ¶æ…‹ã®ã†ã¡ãªã‚‹ã¹ãå…·ä½“çš„ãªã‚‚ã®ã‚’æ±‚ã‚ã‚‹ã€ã¨ã„ã†å•é¡Œã§ã‚ã‚‹ã€Œãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è§£æå•é¡Œã€ã‚’è§£ãã“ã¨ãŒã§ãã¾ã™ã€‚<br>ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è§£æå•é¡Œã«å¯¾ã—ã¦ã¯ã€æŠ½è±¡çŠ¶æ…‹ã¨ãã®é †åº, ãã—ã¦æ„å‘³é–¢æ•°ãŒ<br><ol><li>æ„å‘³é–¢æ•°ãŒå˜èª¿</li><li>æŠ½è±¡çŠ¶æ…‹ã¨é †åºé–¢ä¿‚ãŒç„¡é™ä¸Šæ˜‡é–ã‚’æŒãŸãªã„æŸã‚’ãªã™</li></ol><br>ã¨ã„ã†æ¡ä»¶ã‚’æº€ãŸã™ã¨ãã«åœæ­¢ã™ã‚‹æ±‚è§£ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒçŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚<br>ä¸€ã¤ç›®ã®æ¡ä»¶ã¯ã€é †åºãŒå…·ä½“åº¦ã‚’è¡¨ã™ã“ã¨ã«ã™ã‚‹ã¨<br>ã€Œã‚ˆã‚Šå…·ä½“çš„ãªçŠ¶æ³ã§é–¢æ•°ã‚’å®Ÿè¡Œã—ãŸçµæœã¯ã€ã‚ˆã‚Šå…·ä½“çš„ã«ãªã‚‹ã€<br>ã¨è¡¨ç¾ã§ãã‚‹ã‚ã‘ã§ã€ã“ã‚Œã¯è‡ªç„¶ãªæ¡ä»¶ã§ã™ã€‚<br>äºŒã¤ç›®ã®æ¡ä»¶ã«ã¤ã„ã¦ã“ã“ã§èª¬æ˜ã™ã‚‹ã®ã¯ã‚„ã‚„å¤§å¤‰ã§ã™ã€‚æŠ•ã’ã‚„ã‚Šã§ç”³ã—è¨³ãªã„ã§ã™ãŒã€ã‚„ã¯ã‚Šå…ˆã»ã©ã®ãƒªãƒ³ã‚¯ã‚’è¦‹ã¦ãã ã•ã„ã€‚<br><br>ä»Šå›ã‚‚ã“ã‚Œã‚’ä½¿ã£ã¦å‹æ¨è«–ã‚’è¡Œã„ã¾ã™ã€‚<br><script>page_contents.push({
    "type":"H2",
    "id":"542",
    "title":"ä½œã‚‹ã‚‚ã® ã€œ ç†è«–ç·¨ ã€œ"
});
</script>
<h2 id="542">ä½œã‚‹ã‚‚ã® ã€œ ç†è«–ç·¨ ã€œ</h2><br>ã§ã¯ã€å®Ÿéš›ã« Julia ã®å‡¦ç†ç³»ã‚’æ¨¡å€£ã—ãŸç°¡æ˜“çš„ãªå‡¦ç†ç³»ã‚’ä½œã£ã¦ã„ãã¾ã™ã€‚ (mu ã¨ã„ã†åå‰ã‚’ã¤ã‘ã¾ã—ãŸã€‚)<br>å®Ÿè£…ã¯ã™ã¹ã¦<br>https://github.com/abap34/mu<br>ã«ç½®ã„ã¦ãŠãã¾ã™ã€‚(è‰¯ã‹ã£ãŸã‚‰ star ã¤ã‘ã¦ãã ã•ã„)<br><br>ä»Šå›ä½œã‚‹è¨€èªã¯å¤šé‡ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚ã¤ã¾ã‚Šã€<br><div class="code-block"> <pre><code class="language-julia">function f(x::Int, y::Int){
    return complex_function(x, y)
}

function f(x::Real, y::Real){
    _check_calcuable(x, y)
    return complex_function(x, y)
}

function main(){
    f(1, 2) # =&gt; complex_function(1, 2)
    f(1.0, 2.0) # =&gt; _check_calcuable(1.0, 2.0); complex_function(1.0, 2.0)
}
</code></pre> </div><br>ã®ã‚ˆã†ãªçµæœã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚<br>ã•ã‚‰ã«ã€ã“ã®ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã‚’é™çš„ã«è§£æ±ºãŒã§ãã‚‹å ´åˆã¯è§£æ±ºã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚ ã¤ã¾ã‚Šã€<span class="inline-code"> <code>f(x, y)</code> </span> ã¨ã„ã†å‘¼ã³å‡ºã—ã«ãŠã„ã¦ <span class="inline-code"> <code>x</code> </span>, <span class="inline-code"> <code>y</code> </span> ã¯ <span class="inline-code"> <code>Int</code> </span> ã ã€ãªã©ã¨ã„ã†äº‹å®ŸãŒå°ã‘ãŸå ´åˆã«ã¯ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã‚’å®Ÿè¡Œæ™‚ã«ã¯ãƒãƒ¼ã‚³ã‚¹ãƒˆã§è¡Œãˆã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ (ã¤ã¾ã‚Šãƒã‚§ãƒƒã‚¯ãŒãƒãƒ¼ã‚³ã‚¹ãƒˆã§ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã™)<br><script>page_contents.push({
    "type":"H3",
    "id":"570",
    "title":"å‹"
});
</script>
<h3 id="570">å‹</h3><br>ç°¡å˜ã®ãŸã‚ã«ã€ãƒ¦ãƒ¼ã‚¶å®šç¾©å‹ã¯ä½œã‚Œãªã„ã“ã¨ã«ã—ã¦ã€ã“ã®è¨€èªã«ç¾ã‚Œã‚‹å‹ã¯ä»¥ä¸‹ã§å›ºå®šã•ã‚Œã¦ã„ã‚‹ã¨ã—ã¾ã™ã€‚<br><ul><li><span class="inline-code"> <code>Any</code> </span></li><li><span class="inline-code"> <code>Bottom</code> </span></li><li><span class="inline-code"> <code>Number</code> </span></li><li><span class="inline-code"> <code>Real</code> </span></li><li><span class="inline-code"> <code>Int</code> </span></li><li><span class="inline-code"> <code>Float</code> </span></li><li><span class="inline-code"> <code>Bool</code> </span> </li><li><span class="inline-code"> <code>AbstractString</code> </span></li><li><span class="inline-code"> <code>String</code> </span></li><li><span class="inline-code"> <code>Union{T, U ...}</code> </span></li><li><span class="inline-code"> <code>Tuple{T, U ...}</code> </span></li><li><span class="inline-code"> <code>AbstractArray</code> </span></li><li><span class="inline-code"> <code>Array{T, n}</code> </span> </li></ul><br>ã¾ãšã¯ä¸€éƒ¨ã®è¦‹æ…£ã‚Œãªã„å‹ã®èª¬æ˜ã‚’å«ã‚ã¦ã€ã“ã®è¨€èªãŒã¨ã‚‹å‹ã‚·ã‚¹ãƒ†ãƒ ã«ã¤ã„ã¦å°‘ã—æ›¸ãã¾ã™ã€‚<br>ã¾ãŸã€ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã¯ Julia ã®å‹ã‚·ã‚¹ãƒ†ãƒ ã‚’æ¨¡å€£ã—ãŸã‚‚ã®ã«ãªã£ã¦ã„ã¾ã™ã€‚<br><script>page_contents.push({
    "type":"H4",
    "id":"609",
    "title":"å‹ã®éšå±¤æ§‹é€ "
});
</script>
<h4 id="609">å‹ã®éšå±¤æ§‹é€ </h4><br>ã“ã®è¨€èªã®å‹ã®é›†åˆã¯ä»¥ä¸‹ã®ã‚ˆã†ãªè¦ªå­é–¢ä¿‚ã§åŠé †åºé›†åˆã‚’ãªã—ã¾ã™ã€‚<br>å‹ <span class="inline-code"> <code>B</code> </span> ãŒ <span class="inline-code"> <code>A</code> </span> ã® è¦ªã§ã‚ã‚‹ã“ã¨ã‚’ <span class="inline-code"> <code>A &lt;: B</code> </span> ã¨ã‹ãã“ã¨ã«ã—ã¦ã€<br><div class="info"><span class="strong"> <strong>è¦ªå­é–¢ä¿‚</strong> </span> <span class="inline-code"> <code>A</code> </span> ã§ã‚ã‚‹å€¤ã®é›†åˆãŒ <span class="inline-code"> <code>B</code> </span> ã§ã‚ã‚‹å€¤ã®é›†åˆã®éƒ¨åˆ†é›†åˆã§ã‚ã‚‹ã¨ãã€ã¾ãŸãã®ã¨ãã«é™ã‚Š <span class="inline-code"> <code>A &lt;: B</code> </span></div><br>ã“ã®è€ƒãˆæ–¹ã«ãã£ã¦ã€ä»Šå›ç™»å ´ã™ã‚‹å‹ã«ä»¥ä¸‹ã®ã‚ˆã†ãªã‚°ãƒ©ãƒ•ã§è¡¨ã•ã‚Œã•ã‚Œã‚‹ã‚ˆã†ãªè¦ªå­é–¢ä¿‚ã‚’å®šã‚ã¾ã™ã€‚<br>ã“ã®ã‚°ãƒ©ãƒ•ã«ç¾ã‚Œã‚‹å‹ã®çµ„ã«ã¤ã„ã¦ã¯ã€<span class="inline-code"> <code>A</code> </span> ã¨<span class="inline-code"> <code>B</code> </span>ãŒåŒã˜ã‹ã€ã“ã®ã‚°ãƒ©ãƒ•ã® <span class="inline-code"> <code>Any</code> </span> ã‹ã‚‰ <span class="inline-code"> <code>Bottom</code> </span> ã¸ã®çµŒè·¯ã§ã‚ã£ã¦ã€<span class="inline-code"> <code>B</code> </span> ãŒ <span class="inline-code"> <code>A</code> </span> ã‚ˆã‚Šã‚‚å…ˆã«å‡ºã¦ãã‚‹ã‚‚ã®ãŒã‚ã‚‹ã¨ãã€ã¾ãŸãã®ã¨ãã«é™ã‚Š <span class="inline-code"> <code>B</code> </span> ã¯ <span class="inline-code"> <code>A</code> </span> ã®è¦ªã§ã™ã€‚<br><figure><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3929241/78c32648-ce21-41e0-bde0-f564a65a4b23.png" ><figcaption>image.png</figcaption></figure><br><br>ä¾‹ãˆã° <span class="inline-code"> <code>Int &lt;: Real</code> </span>, <span class="inline-code"> <code>Int &lt;: Int</code> </span>, <span class="inline-code"> <code>Float &lt;: Number</code> </span> ã§ã™ã€‚<br><br><script>page_contents.push({
    "type":"H3",
    "id":"665",
    "title":"å…·è±¡å‹ã¨æŠ½è±¡å‹"
});
</script>
<h3 id="665">å…·è±¡å‹ã¨æŠ½è±¡å‹</h3><br>ã“ã“ã§ã€ä¸Šã®ã‚°ãƒ©ãƒ•ã§ã€é ‚ç‚¹ãŒã‚ªãƒ¬ãƒ³ã‚¸ã¨æ°´è‰²ã§å¡—ã‚Šåˆ†ã‘ã‚‰ã‚Œã¦ã„ã¾ã—ãŸãŒã€<br>ã“ã‚Œã¯ã€ä»Šå›ã®è¨€èªã®å‹ã‚·ã‚¹ãƒ†ãƒ ã«ãŠã‘ã‚‹ <span class="strong"> <strong>å…·è±¡å‹ (Concreate Type)</strong> </span> ã¨ <span class="strong"> <strong>æŠ½è±¡å‹ (Abstract Type)</strong> </span> ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚<br>å…·è±¡å‹ã¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒä½œã‚Œã‚‹å‹ã®ã“ã¨ã§ã™ã€‚<br>ã¤ã¾ã‚Šã€<span class="inline-code"> <code>x</code> </span> ã®å€¤ã®å‹ã‚’å–å¾—ã™ã‚‹é–¢æ•° <span class="inline-code"> <code>typeof(x)</code> </span> ã®ã‚ˆã†ãªé–¢æ•°ãŒã‚ã£ãŸã¨ãã€ã“ã‚Œã®è¿”ã‚Šå€¤ã¯å¿…ãšå…·è±¡å‹ã«ãªã‚Šã¾ã™ã€‚æŠ½è±¡å‹ã§ã‚ã‚‹ <span class="inline-code"> <code>Any</code> </span>, <span class="inline-code"> <code>Number</code> </span> ãªã©ãŒè¿”ã‚‹ã“ã¨ã¯æ±ºã—ã¦ã‚ã‚Šã¾ã›ã‚“ã€‚<br>ä»Šå›ã®å ´åˆ <span class="inline-code"> <code>Int</code> </span>, <span class="inline-code"> <code>Float</code> </span>, <span class="inline-code"> <code>Bool</code> </span>, <span class="inline-code"> <code>String</code> </span> ãªã©ãŒå…·è±¡å‹ã«ã‚ãŸã‚Šã¾ã™ã€‚<br>æŠ½è±¡å‹ã¯å…·è±¡å‹ã‚’ã¾ã¨ã‚ã¦æ§‹é€ åŒ–ã—ã¦ã€å¤šé‡ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã®åˆ¶å¾¡ã‚’ã—ã‚„ã™ãã™ã‚‹ã“ã¨ãŒãã®å½¹å‰²ã§ã™ã€‚<br><script>page_contents.push({
    "type":"H4",
    "id":"702",
    "title":"<span class="inline-code"> <code>Array{T, n}</code> </span> å‹"
});
</script>
<h4 id="702"><span class="inline-code"> <code>Array{T, n}</code> </span> å‹</h4><br><span class="inline-code"> <code>Array{T, n}</code> </span> å‹ã®èª¬æ˜ã‚’ã—ã¾ã—ã‚‡ã†ã€‚<br>ã“ã‚Œã¯ã€å…¨ã¦ã®è¦ç´ ã®å‹ãŒå…¨ã¦ <span class="inline-code"> <code>T</code> </span> ã®å­ã§ã‚ã‚‹ <span class="inline-code"> <code>n</code> </span> æ¬¡å…ƒé…åˆ—ã§ã™ã€‚<span class="footnote-ref"><sup id="ref_arrayattent"><a href="#label_arrayattent">[arrayattent]</a></sup></span><br><br><span class="inline-code"> <code>{T, n}</code> </span> ã¯å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨å‘¼ã°ã‚Œã‚‹ã‚‚ã®ã§ã€ä¾‹ãˆã° <span class="inline-code"> <code>Array{String, 1}</code> </span> ã¨ã—ã¦æ–‡å­—åˆ—ã‹ã‚‰ãªã‚‹ 1æ¬¡å…ƒé…åˆ—ã‚’ã€ <span class="inline-code"> <code>Array{Real, 2}</code> </span> ã§å®Ÿæ•° (ä»Šå›ã¯ <span class="inline-code"> <code>Int</code> </span> ã¾ãŸã¯ <span class="inline-code"> <code>Float</code> </span>) ã‹ã‚‰ãªã‚‹ 2æ¬¡å…ƒé…åˆ—ãªã©ã‚’è¡¨ç¾ã§ãã¾ã™ã€‚<br>å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å°å…¥ã—ãŸã¨ãã«è€ƒãˆã‚‹å¿…è¦ãŒã‚ã‚‹ã®ãŒæ¬¡ã®ã‚ˆã†ãªå•ã„ã§ã™ã€‚<br><div class="warn"><span class="inline-code"> <code>Array{Real, 1}</code> </span> ã¯ <span class="inline-code"> <code>Array{Int, 1}</code> </span> ã®è¦ªã‹ï¼Ÿ</div><br>ä»Šå›ã®å‹ã‚·ã‚¹ãƒ†ãƒ ã¯ã€<span class="inline-code"> <code>Array</code> </span> ã«ã¤ã„ã¦ä»¥ä¸‹ã®ã‚ˆã†ãªè¦å‰‡ã‚’æ¡ç”¨ã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚<br><div class="info"><span class="strong"> <strong>ä¸å¤‰æ€§ (Invariance)</strong> </span><br><span class="inline-code"> <code>Array{T}</code> </span> ã¯ <span class="inline-code"> <code>B</code> </span> <span class="math-inline"> \( \neq \) </span> <span class="inline-code"> <code>C</code> </span>  ãªã‚‹ ä»»æ„ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ <span class="inline-code"> <code>B</code> </span>, <span class="inline-code"> <code>C</code> </span> ã«ã¤ã„ã¦ <span class="inline-code"> <code>Array{B}</code> </span> ã¨ <span class="inline-code"> <code>Array{C}</code> </span> ã¯è¦ªå­é–¢ä¿‚ã§ãªã„ã€‚</div><br>ã¤ã¾ã‚Šã€<span class="strong"> <strong><span class="inline-code"> <code>Array{Real, 1}</code> </span> ã¯ <span class="inline-code"> <code>Array{Int, 1}</code> </span> ã®è¦ªã§ã¯ãªã„ã“ã¨ã«ã—ã¾ã™ã€‚</strong> </span><br>ã“ã®ã‚ˆã†ãªæ€§è³ªâ”€<br><ul><li>å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ <span class="inline-code"> <code>T</code> </span> ã‚’æŒã¤å‹ <span class="inline-code"> <code>A{T}</code> </span> ãŒ ä»»æ„ã®ç›¸ç•°ãªã‚‹å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿<span class="inline-code"> <code>S</code> </span>, <span class="inline-code"> <code>T</code> </span> ã«å¯¾ã—ã¦ (ãŸã¨ãˆ <span class="inline-code"> <code>S &lt;: T</code> </span> ã§ã‚ã£ã¦ã‚‚)  <span class="inline-code"> <code>A{S} &lt;: A{T}</code> </span> ã§ãªã„</li></ul><br><br>ã®ã“ã¨ã‚’ <span class="strong"> <strong>ä¸å¤‰æ€§ (Invariance)</strong> </span> ã¨ã„ã„ã¾ã™ã€‚<br>ä¸å¤‰æ€§ã‚’æ¡ç”¨ã™ã‚‹ã“ã¨ãŒä»•æ§˜ã¨ã—ã¦çµ¶å¯¾ã®æ­£è§£ã‹ã¨ã„ã†ã¨å…¨ç„¶ãã‚“ãªã“ã¨ã¯ãªãã€ ãã‚‚ãã‚‚ Julia ã®å‹ã‚·ã‚¹ãƒ†ãƒ ã«ãŠã„ã¦ã‚‚ä¾‹å¤–ãŒå­˜åœ¨ã—ã¾ã™ã—(å¾Œè¿°ã—ã¾ã™)ã€è‰²ã€…ãªè¨€èªã§ã„ã‚ã„ã‚ãªã‚·ã‚¹ãƒ†ãƒ ãŒæ¡ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚é€†ã« <span class="inline-code"> <code>B &lt;: C</code> </span> ãªã‚‰ã° <span class="inline-code"> <code>A{B} &lt;: A{C}</code> </span> ã¨ã„ã†æ€§è³ªã‚’ <span class="strong"> <strong>å…±å¤‰æ€§ (Covariance)</strong> </span> ã¨ã„ã„ã¾ã™ã€‚<br>ã“ã‚Œã‚‰ã®èª¬æ˜ã‚‚é•·ããªã£ã¦ã—ã¾ã†ã®ã§æ°—ã«ãªã‚‹ã‹ãŸã¯ã“ã‚Œã‚‰ã®ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢ã—ã¦ãã ã•ã„ã€‚<br>ã¨ã«ã‹ãã€ã“ã£ã¡ã‚’æ¡ç”¨ã—ãŸã“ã¨ã«ã‚ˆã£ã¦å…ˆã»ã©ã®è¦ªå­é–¢ä¿‚ãŒãªã™éšå±¤æ§‹é€ ã¯ã“ã‚“ãªæ„Ÿã˜ã«ãªã‚Šã¾ã™ã€‚<br><figure><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3929241/c5cdd4ec-3b38-f5ed-8503-a60965099166.png" ><figcaption>image.png</figcaption></figure><br>å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦ <span class="inline-code"> <code>n</code> </span> ãŒè¿½åŠ ã•ã‚ŒãŸã“ã¨ã§ã€å‹ã®æ•°ãŒæœ‰é™ã§ãªããªã‚Šã¾ã—ãŸã€‚<br><br><script>page_contents.push({
    "type":"H4",
    "id":"822",
    "title":"<span class="inline-code"> <code>Any</code> </span> å‹"
});
</script>
<h4 id="822"><span class="inline-code"> <code>Any</code> </span> å‹</h4><br><span class="inline-code"> <code>Any</code> </span> å‹ã¯ç°¡å˜ã«ã„ã†ã¨ä»»æ„ã®å€¤ã‚’è¡¨ã™æŠ½è±¡å‹ã§ã™ã€‚ å–ã‚Šã†ã‚‹å€¤ãŒã“ã®è¨€èªã«å­˜åœ¨ã™ã‚‹ã™ã¹ã¦ã®å€¤ã§ã‚ã‚‹ã“ã¨ã‚’è¡¨ã—ã¾ã™ã€‚<br>ä»Šå›ã¯ã“ã‚ŒãŒè¦ªå­é–¢ä¿‚ã«ãŠã‘ã‚‹æœ€å¤§å…ƒã€ã¤ã¾ã‚Šä»»æ„ã®å‹ <span class="inline-code"> <code>T</code> </span> ã«å¯¾ã—ã¦ <span class="inline-code"> <code>T &lt;: Any</code> </span> ãªå‹ã«ãªã‚Šã¾ã™ã€‚<br><script>page_contents.push({
    "type":"H4",
    "id":"835",
    "title":"<span class="inline-code"> <code>Bottom</code> </span> å‹"
});
</script>
<h4 id="835"><span class="inline-code"> <code>Bottom</code> </span> å‹</h4><br>ã¨ãªã‚‹ã¨ã€é€†ã«å–ã‚Šã†ã‚‹å€¤ãŒå­˜åœ¨ã—ãªã„ã“ã¨ã‚’è¡¨ã™å‹ãŒæœ€å°å…ƒã¨ãªã‚Šã¾ã™ã€‚<br>ä»Šå›ã¯ã“ã‚Œã‚’ <span class="inline-code"> <code>Bottom</code> </span> ã¨ã„ã†åå‰ã«ã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚<br>ã¤ã¾ã‚Š ä»»æ„ã®å‹ <span class="inline-code"> <code>T</code> </span> ã«å¯¾ã—ã¦ <span class="inline-code"> <code>Bottom &lt;: T</code> </span> ã§ã™ã€‚<br><script>page_contents.push({
    "type":"H4",
    "id":"851",
    "title":"<span class="inline-code"> <code>Tuple</code> </span> å‹"
});
</script>
<h4 id="851"><span class="inline-code"> <code>Tuple</code> </span> å‹</h4><br>Tuple ã¯å€¤ã®çµ„ã‚’è¡¨ã™å‹ã§ã€å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦å‹ã®çµ„ã‚’å–ã‚Šã¾ã™ã€‚<br>ä¾‹ãˆã° <span class="inline-code"> <code>(1, 2.0, 3)</code> </span> ã¯ <span class="inline-code"> <code>Tuple{Int, Float, Int}</code> </span>ã€€ã®å€¤ã§ã™ã€‚<br>ã“ã“ã§æ³¨æ„ç‚¹ã¨ã—ã¦ã€<span class="strong"> <strong><span class="inline-code"> <code>Tuple</code> </span> å‹ã¯å…±å¤‰æ€§ã‚’æŒã¤ã“ã¨ã«ã—ã¾ã™ã€‚</strong> </span> ä¾‹ãˆã° <span class="inline-code"> <code>Tuple{Int, Float, Int} &lt;: Tuple{Int, Real, Real}</code> </span> ã§ã™ã€‚<br>ã¨ã„ã†ã®ã‚‚ã€<span class="inline-code"> <code>Tuple</code> </span>å‹ ãŒã‚·ã‚°ãƒãƒãƒ£ã‚’è¡¨ç¾ã™ã‚‹ãŸã‚ã«ç”¨ã„ã‚‰ã‚Œã‚‹ã‹ã‚‰ã§ã™ã€‚<br>å¤šé‡ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã®èª¬æ˜ã§æ›¸ã„ãŸã‚ˆã†ã«ã€ãƒ¡ã‚½ãƒƒãƒ‰ã‚’é¸æŠã™ã‚‹éš›ã«ã¯å¼•æ•°ã®å‹ã®ã†ã¡ã©ã‚ŒãŒã‚‚ã£ã¨ã‚‚ç‰¹åŒ–ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’èª¿ã¹ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®æ¯”è¼ƒã‚’æˆã‚Šç«‹ãŸã›ã‚‹ã«ã¯å…±å¤‰æ€§ã‚’æŒãŸã›ã‚‹ã®ãŒè‡ªç„¶ã§ã™ã€‚<br><span class="inline-code"> <code>Tuple</code> </span> å‹ã‚‚å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦ä»»æ„å€‹ã®å‹ã‚’å–ã‚Šã¾ã™ã‹ã‚‰ã€ã“ã‚Œã‚’å°å…¥ã™ã‚‹ã¨ã‚„ã¯ã‚Šå‹ã®é›†åˆãŒç„¡é™å€‹ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚<br><br><script>page_contents.push({
    "type":"H4",
    "id":"881",
    "title":"<span class="inline-code"> <code>Union</code> </span> å‹"
});
</script>
<h4 id="881"><span class="inline-code"> <code>Union</code> </span> å‹</h4><br><span class="inline-code"> <code>Union</code> </span> å‹ã¯ã€å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦éç©ºã® <span class="footnote-ref"><sup id="ref_bottom"><a href="#label_bottom">[bottom]</a></sup></span> å‹ã®é›†åˆã‚’å–ã‚Šã¾ã™ã€‚<br>ã“ã‚Œã¯åå‰ã®é€šã‚Šå’Œé›†åˆã®è¡¨ç¾ã«è¿‘ãã€ <span class="inline-code"> <code>S &lt;: Union{S, T, U}</code> </span>, <span class="inline-code"> <code>T &lt;: Union{S, T, U}</code> </span>, <span class="inline-code"> <code>U &lt;: Union{S, T, U}</code> </span> ã§ã™ã€‚<br><br><span class="inline-code"> <code>Union</code> </span> å‹ã‚’å«ã‚€è¦ªå­é–¢ä¿‚ã¯ Julia ã®ä»•æ§˜ã«æ²¿ã£ã¦ä»¥ä¸‹ã®ã‚ˆã†ã«å®šã‚ã¾ã™ã€‚<span class="footnote-ref"><sup id="ref_juliasubtyping"><a href="#label_juliasubtyping">[juliasubtyping]</a></sup></span><br><br><br><div class="info"><span class="strong"> <strong><span class="inline-code"> <code>Union</code> </span> å‹ <span class="inline-code"> <code>U</code> </span> (å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ <span class="inline-code"> <code>T</code> </span>) ã¨ å‹<span class="inline-code"> <code>S</code> </span>ã®è¦ªå­é–¢ä¿‚</strong> </span><br><span class="inline-code"> <code>T</code> </span> ã®å…¨ã¦ã®è¦ç´ ãŒ <span class="inline-code"> <code>S</code> </span> ã®å­ã§ã‚ã‚‹ã¨ãã€ã¾ãŸãã®ã¨ãã«é™ã‚Š <span class="inline-code"> <code>U &lt;: S</code> </span> ã‚ã‚‹ <span class="inline-code"> <code>T</code> </span> ã®è¦ç´ ãŒå­˜åœ¨ã—ã¦ <span class="inline-code"> <code>S</code> </span> ã®è¦ªã§ã‚ã‚‹ã¨ãã€ã¾ãŸãã®ã¨ãã«é™ã‚Š <span class="inline-code"> <code>S &lt;: U</code> </span><br></div><br><details> <summary> Tupleå‹ã‚‚å«ã‚€è¦ªå­é–¢ä¿‚ </summary><br><hr><br><br><span class="inline-code"> <code>Union</code> </span> å‹ã®è¦ªå­é–¢ä¿‚ã¯ <span class="inline-code"> <code>Tuple</code> </span> ã‚‚çµ¡ã‚€ã¨ã‚ˆã‚Šã‚„ã‚„ã“ã—ããªã‚Šã¾ã™ã€‚<br>ã¨ã„ã†ã®ã‚‚ã€åŒã˜é›†åˆã‚’è¡¨ã™è¤‡æ•°ã®è¡¨ç¾ãŒå­˜åœ¨ã™ã‚‹ã‹ã‚‰ã§ã™ã€‚ä¾‹ãˆã° <span class="inline-code"> <code>Tuple{Int, Union{Int, Float}}</code> </span> ã¯ <span class="inline-code"> <code>Union{Tuple{Int, Int}, Tuple{Int, Float}}</code> </span> ã¨ç­‰ä¾¡ã§ã™ã€‚<br>ç°¡å˜ãªå®Ÿè£…ã®ä»•æ–¹ã¨ã—ã¦ã¯ã€é©å½“ãªæ¨™æº–å½¢ã«å¤‰æ›ã—ã¦ã—ã¾ã£ã¦æ¯”è¼ƒã™ã‚‹ã¨ã„ã†æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚ ä¾‹ãˆã° <span class="inline-code"> <code>Union</code> </span> ã¯ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã«ã®ã¿å­˜åœ¨ã™ã‚‹ã‚ˆã†ã«å¤‰æ›ã™ã‚‹ã®ã¯å®¹æ˜“ã§ã™ã€‚<br>ã“ã®æ–¹æ³•ã¯å®Ÿè£…ã¯å®¹æ˜“ã§ã™ãŒå‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒã‚¹ãƒˆã®æ·±ã•ã«å¯¾ã—ã¦æŒ‡æ•°æ™‚é–“ã‹ã‹ã‚Šã¾ã™ã€‚ ãªã®ã§ Julia ã®å‡¦ç†ç³»ã§ã¯ã‚ˆã‚Šé«˜é€Ÿãªæ–¹æ³•ãŒç”¨ã„ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚<span class="footnote-ref"><sup id="ref_fastsubtyping"><a href="#label_fastsubtyping">[fastsubtyping]</a></sup></span><br><br>ã“ã®ã‚ˆã†ã«è¦ªå­é–¢ä¿‚ã®åˆ¤å®šã¯å®Ÿã¯å°‘ã—ã‚„ã‚„ã“ã—ãã€é€²ã‚“ã é¢ç™½ã„çµæœã¨ã—ã¦ã€å°‘ã—å‰ã¾ã§ã¯ Julia ã®è¦ªå­é–¢ä¿‚ã®åˆ¤å®šã¯æ±ºå®šä¸èƒ½ã§ã‚ã£ãŸã¨ã„ã†ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚<span class="footnote-ref"><sup id="ref_juliasubtypingdecide"><a href="#label_juliasubtypingdecide">[juliasubtypingdecide]</a></sup></span><br><br><br><br><br><hr><br><br><br></details><br><br><br><br><br><br>ã•ã¦ã€ã“ã¨å‹æ¨è«–ã®ã“ã¨ã‚’è€ƒãˆã‚‹ã¨ã€ifæ–‡ã®åˆ†å²ã§ãã‚Œãã‚Œ <span class="inline-code"> <code>Int</code> </span>, <span class="inline-code"> <code>Float</code> </span> ãŒè¿”ã‚‹ã‚ˆã†ãªã‚±ãƒ¼ã‚¹ã§ã¯ <span class="inline-code"> <code>Union{Int, Float}</code> </span> ã®ã‚ˆã†ã«è¡¨ç¾ã§ããã†ã§ã™ã‹ã‚‰ã€ã“ã‚Œã‚’å°å…¥ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦å¼·ã„è¡¨ç¾åŠ›ãŒå¾—ã‚‰ã‚Œãã†ãªæ„Ÿã˜ãŒã—ã¾ã™ã€‚<br><br><div class="code-block"> <pre><code class="language-julia">function f(x)
    if x &gt; 0
        return 1
    else 
      return 1.0    
    end
end   # =&gt; Union{Int, Float64}
</code></pre> </div><br><br><br>ã—ã‹ã—ã€å¼·ã„ã‚‚ã®ã®è¨ˆç®—ãŒå¤§å¤‰ãªã®ã¯ä¸–ã®å¸¸ã§ã™ã€‚<br><span class="inline-code"> <code>Union</code> </span> å‹ã¯å¼·åŠ›ã§ã™ãŒå‹ã‚·ã‚¹ãƒ†ãƒ ã®å–ã‚Šæ‰±ã„ã‚’ã¨ã¦ã‚‚ã‚„ã‚„ã“ã—ãã—ã¾ã™ã€‚<br>ã“ã“ã‹ã‚‰ã¯ãã®ã“ã¨ã‚’è¦‹ã¦ã„ãã¾ã™ã€‚<br><script>page_contents.push({
    "type":"H4",
    "id":"1010",
    "title":"æŸã¨ã—ã¦ã®æ€§è³ªã€€â”€ æœ‰é™æ€§æ¡ä»¶ã®åä¾‹"
});
</script>
<h4 id="1010">æŸã¨ã—ã¦ã®æ€§è³ªã€€â”€ æœ‰é™æ€§æ¡ä»¶ã®åä¾‹</h4><br>ä»Šå›è€ƒãˆã‚‹ã€€(å‹ã®é›†åˆ, è¦ªå­é–¢ä¿‚)  ã¯å®Ÿã¯æŸã«ãªã£ã¦ã„ã¾ã™ã€‚<br><br>ã§ã¯å‹æ¨è«–ã¯ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è§£æå•é¡Œã«è½ã¨ã—ã“ã‚ã°ã‚¹ãƒƒã¨è§£ã‘ã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿ<br>å®Ÿã¯ã“ã®ã¾ã¾ã ã¨ã†ã¾ãã„ãã¾ã›ã‚“ã€‚ ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è§£æå•é¡Œã®åå¾©è§£æ³•ã¯ãã®åœæ­¢æ€§ã®ãŸã‚ã«<br><ul><li>æ„å‘³é–¢æ•°ã®å˜èª¿æ€§</li><li>æŠ½è±¡çŠ¶æ…‹ã®æŸã®é«˜ã•ã®æœ‰é™æ€§</li></ul><br><br>ã‚’è¦æ±‚ã—ã¦ã„ã¾ã—ãŸã€‚ã—ã‹ã—ã€ä»Šå›ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªç„¡é™é•·ã®ä¸Šæ˜‡é–ãŒæ§‹æˆã§ãã¦ã—ã¾ã„ã¾ã™ã€‚<br><div class="code-block"> <pre><code class="language-julia">Union{Vector{Int, 1}} 
&lt;: Union{Array{Int, 1}, Array{Int, 2}} 
&lt;: Union{Array{Int, 1}, Array{Int, 2}, Array{Int, 3}} 
&lt;: Union{Array{Int, 1}, Array{Int, 2}, Array{Int, 3}, Array{Int, 4}} 
...
</code></pre> </div><br>å‹é›†åˆãŒç„¡é™ã«ã‚ã‚‹ã“ã¨ã€<span class="inline-code"> <code>Union</code> </span> å‹ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã“ã®ã‚ˆã†ãªå•é¡ŒãŒç™ºç”Ÿã—ã¦ã—ã¾ã£ãŸã‚ã‘ã§ã™ã€‚<br>ãªã®ã§ã€å˜ç´”ã«å‰å›ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’é©ç”¨ã™ã‚‹ã ã‘ã§ã¯åæŸæ€§ãŒä¿è¨¼ã•ã‚Œã¾ã›ã‚“ã€‚<br>ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å…·ä½“çš„ãªå®Ÿè¡ŒãŒåœæ­¢ã™ã‚‹ä¿è¨¼ã¯å½“ç„¶ã—ãªãã¦ã„ã„ã‚ã‘ã§ã™ãŒã€ ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒ—ãƒ­ã‚»ã‚¹ã¯ã€ãã‚ŒãŒãŸã¨ãˆä¸æ­£ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã‚ã£ãŸã¨ã—ã¦ã‚‚å¿…ãšåœæ­¢ã•ã›ãªã‘ã‚Œã°ã„ã‘ã¾ã›ã‚“ã€‚<br>ãã“ã§ <span class="strong"> <strong>Widening</strong> </span> ã¨å‘¼ã°ã‚Œã‚‹æŠ½è±¡è§£é‡ˆã§ä¸€èˆ¬çš„ãªãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’ä½¿ã†ã“ã¨ã§ãã®åœæ­¢æ€§ã‚’å¾©æ´» (?) ã•ã›ã¾ã™ã€‚<br>ä¸€æ—¦ã€ã„ã‚ã„ã‚å¿˜ã‚Œã¦ Widening ã«ã¤ã„ã¦ã¿ã¦ã„ãã“ã¨ã«ã—ã¾ã™ã€‚<br><script>page_contents.push({
    "type":"H2",
    "id":"1046",
    "title":"Widening"
});
</script>
<h2 id="1046">Widening</h2><br>Widening ã¯ã€(ä»Šã®çŠ¶æ…‹, æ›´æ–°ã—ãŸã„çŠ¶æ…‹) ã‹ã‚‰æ¬¡ã®çŠ¶æ…‹ã‚’å‡ºåŠ›ã™ã‚‹ <span class="math-inline"> \( \nabla \) </span> ã«æœ›ã¾ã—ã„æ€§è³ªã‚’æŒãŸã›ã‚‹ã“ã¨ã§ç„¡é™é•·ã®é–ã‚’æœ‰é™å›ã§ç™»ã‚Šåˆ‡ã‚Œã‚‹ã‚ˆã†ã«ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã§ã™ã€‚<br>ã¾ãšã¯å®šç¾©ã¨ä¾‹ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚<br><script>page_contents.push({
    "type":"H3",
    "id":"1055",
    "title":"Widening Operator"
});
</script>
<h3 id="1055">Widening Operator</h3><br><span class="math-inline"> \( (P, \leq) \) </span> ãŒåŠé †åºé›†åˆã§ã‚ã‚‹ã¨ã™ã‚‹ã€‚<br><span class="math-inline"> \( \nabla: P \times P \rightarrow P \) </span> ãŒæ¬¡ã®ã‚ˆã†ãªæ€§è³ªã‚’æº€ãŸã™ã¨ãã€  <span class="math-inline"> \( \nabla \) </span> ãŒ <span class="strong"> <strong>(pair-) Widening Operator ã§ã‚ã‚‹</strong> </span> ã¨ã„ã†. <span class="footnote-ref"><sup id="ref_setwidening"><a href="#label_setwidening">[setwidening]</a></sup></span><br><br><script>page_contents.push({
    "type":"H4",
    "id":"1073",
    "title":"æ€§è³ª1 (è¢«è¦†æ€§)"
});
</script>
<h4 id="1073">æ€§è³ª1 (è¢«è¦†æ€§)</h4><br>ä»»æ„ã® <span class="math-inline"> \( x, y \in P \) </span> ã§ <span class="math-inline"> \( x \leq x \nabla y \) </span> ã‹ã¤ <span class="math-inline"> \( y \leq x \nabla y \) </span> <br><script>page_contents.push({
    "type":"H4",
    "id":"1084",
    "title":"æ€§è³ª2 (åœæ­¢æ€§)"
});
</script>
<h4 id="1084">æ€§è³ª2 (åœæ­¢æ€§)</h4><br>é– <span class="math-inline"> \( x_0 \leq x_1 \leq x_2 \leq \cdots \) </span> ã«å¯¾ã—ã¦ã€<br><span class="math-inline"> \( y_0 = x_0, \\ y_{i+1} = y_i \nabla x_{i+1} \) </span> ã¨å®šã‚ã‚‹ã€‚ã“ã®ã¨ã <span class="math-inline"> \( \\{ y_i \\}_{i \in \mathbb{N}} \) </span> ã¯æ¬¡ã®æ€§è³ªã‚’æº€ãŸã™ã€‚<br><span class="strong"> <strong>[æ€§è³ª]</strong> </span> ã‚ã‚‹ <span class="math-inline"> \( k \) </span> ãŒå­˜åœ¨ã—ã¦ <span class="math-inline"> \( y_k = y_{k+1} = y_{k+2} = \cdots \) </span> <br><br><script>page_contents.push({
    "type":"H3",
    "id":"1105",
    "title":"å…·ä½“ä¾‹"
});
</script>
<h3 id="1105">å…·ä½“ä¾‹</h3><br><span class="math-inline"> \( P \) </span> ã‚’ã€ã™ã¹ã¦ã®æ•´æ•°åŒºé–“ã®é›†åˆã¨æœ€å°å…ƒã®ãŸã‚ã®ç‰¹åˆ¥ãªè¦ç´ ã‚’åŠ ãˆãŸé›†åˆã€ã¤ã¾ã‚Š<br><span class="math-inline"> \( P = \\{ \bot \\} \cup \\{ [l, u] \mid l \in \mathbb{Z} \cup \\{ -\infty \\}, u \in   \mathbb{Z} \cup \\{ \infty \\}, l < u \\} \) </span><br>ã¨ã—ã¦ã€åŒºé–“ã®åŒ…å«é–¢ä¿‚ã§ <span class="math-inline"> \( \leq \) </span> ã‚’å®šç¾©ã—ã¾ã™ã€‚ (ã“ã“ã§ <span class="math-inline"> \( \bot \) </span> ã¯ä»»æ„ã®åŒºé–“ <span class="math-inline"> \( x \) </span> ã«ã¤ã„ã¦ <span class="math-inline"> \( \bot \subseteq x \) </span> ãªã‚‹ã¨ã—ã¾ã™)<br>ãã—ã¦ã€æ¬¡ã®ã‚ˆã†ã« <span class="math-inline"> \( \nabla \) </span> ã‚’å®šã‚ã¾ã™.<br><div class="math-block"> \[ 

\begin{array}{ll}
\bot \nabla x = & x \\
x \nabla \bot = & x \\
{[l_0, u_0] \nabla [l_1, u_1] =} & \left[
  \begin{array}{l}
    \text{if } l_0 > l_1 \text{ then } -\infty \text{ else } l_0, \\
    \text{if } u_0 < u_1 \text{ then } +\infty \text{ else } u_0
  \end{array}
\right]
\end{array}

 \] </div><br>ã“ã®ã¨ã <span class="math-inline"> \( \nabla \) </span> ã¯ <span class="strong"> <strong>Widening Operator</strong> </span> ã§ã™ã€‚<br>è¢«è¦†æ€§ã¯æ˜ã‚‰ã‹ã«æˆã‚Šç«‹ã¡ã¾ã™ã€‚<br>åœæ­¢æ€§ã‚‚å·¦ç«¯ãƒ»å³ç«¯ã ã‘ãŒæ‹¡å¤§ã™ã‚‹ã‚±ãƒ¼ã‚¹ã¨ä¸¡æ–¹ãŒæ‹¡å¤§ã™ã‚‹ã‚±ãƒ¼ã‚¹ã‚’ãã‚Œãã‚Œè€ƒãˆã‚‹ã¨ã€ã—ãŸãŒã†ã®ãŒç°¡å˜ã«ã‚ã‹ã‚Šã¾ã™ã€‚<br><br><figure><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3929241/d7f1ba6c-105f-b8a1-c34f-3bc511b25c69.png" ><figcaption>image.png</figcaption></figure><br><br><script>page_contents.push({
    "type":"H3",
    "id":"1144",
    "title":"Widening ã®å½¹å‰²"
});
</script>
<h3 id="1144">Widening ã®å½¹å‰²</h3><br>æ›´æ–°æ™‚ã« Widening Operator ã‚’æŒŸã‚€ã“ã¨ã§ç„¡é™ã«çŠ¶æ…‹ãŒæ›´æ–°ã•ã‚Œã‚‹ã“ã¨ãŒãªããªã‚‹ã®ã§ (<span class="math-inline"> \( \because \) </span> åœæ­¢æ€§)ã€ä¸€èˆ¬ã®æŸã«å¯¾ã—ã¦åæŸã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼æ–¹ç¨‹å¼ã®åå¾©è§£æ³•ãŒä½œã‚Œã¾ã™ã€‚<br>ã•ã‚‰ã«ã€Widening ã«ã¯<br><ul><li>è¿‘ä¼¼ç²¾åº¦ã®èª¿ç¯€å½¹</li><li>åæŸã‚’æ—©ã‚ã‚‹ãƒ’ãƒ¥ãƒ¼ãƒªã‚¹ãƒ†ã‚£ãƒƒã‚¯</li></ul><br>ã®å½¹å‰²ã‚’æŒãŸã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚<br>ä¸Šã®ä¾‹ã§ã¯ã™ãã«è«¦ã‚ã¦åŒºé–“ã‚’æœ€å¤§ã¾ã§æ‹¡å¤§ã—ãŸã‚ã‘ã§ã™ãŒã€ä¾‹ãˆã°<br><ul><li>å¹… <span class="math-inline"> \( k \) </span> ã¾ã§ã¯ãã®ã¾ã¾æŒã¤.</li><li>å¹… <span class="math-inline"> \( k \) </span> ã‚’è¶…ãˆãŸã‚‰ <span class="math-inline"> \( [- \infty, + \infty] \) </span>  ã«ã™ã‚‹</li></ul><br>ã‚ˆã†ã« <span class="math-inline"> \( \nabla \) </span> ã‚’å®šç¾©ã™ã‚Œã°ã€<span class="math-inline"> \( k \) </span> ã‚’èª¿ç¯€ã™ã‚‹ã“ã¨ã§æœ›ã¾ã—ã„ç¨‹åº¦ã«è¿‘ä¼¼ç²¾åº¦ã‚’èª¿ç¯€ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚<br>ä»–ã«ã‚‚ã€ãŸã¨ãˆé«˜ã•ãŒæœ‰é™ã§ã‚ã£ã¦ã‚‚éå¸¸ã«é«˜ã„æŸã¯è§£æãŒå®Ÿç”¨çš„ã§ãªã„ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ (æ±‚è§£ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æœ€æ‚ªè¨ˆç®—é‡ã¯æŸã®é«˜ã•ã«æ¯”ä¾‹ã—ã¾ã™)<br>ãã®ã‚ˆã†ãªã¨ãã«é©åˆ‡ã«ã€Œã‚¹ã‚­ãƒƒãƒ—ã€ã—ã¦ãã‚Œã‚‹ Widening Operator ã‚’å°å…¥ã™ã‚‹ã“ã¨ã§ã€é«˜é€Ÿã«åæŸã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚<br><br>ã•ã¦ã€ä»Šå›å®Ÿè£…ã™ã‚‹å‹æ¨è«–ã«ãŠã„ã¦ã‚‚ã€Widening ã«ã‚ˆã£ã¦å‹æ¨è«–ã®åæŸæ€§ã‚’ä¿è¨¼ã—ã¾ã™ã€‚ ã©ã®ã‚ˆã†ãª Widening ã‚’ç”¨ã„ã‚‹ã‹ã¯å®Ÿè£…ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§æ¤œè¨ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ã‚‡ã†ã€‚<br><script>page_contents.push({
    "type":"H3",
    "id":"1188",
    "title":"Widening ã‚’å°å…¥ã—ãŸãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼æ–¹ç¨‹å¼ã®åå¾©è§£æ³•"
});
</script>
<h3 id="1188">Widening ã‚’å°å…¥ã—ãŸãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼æ–¹ç¨‹å¼ã®åå¾©è§£æ³•</h3><br>å‰å›ã®è¨˜äº‹ã«è¼‰ã›ãŸãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å†æ²ã—ã¾ã™ã€‚<br>(å®Ÿã¯è‡ªæ˜ãªåŠ¹ç‡åŒ–ãŒã‚ã‚Šã€ãã‚Œã‚’ã™ã‚‹ã“ã¨ã§å®Ÿéš› Julia ã§ä½¿ã‚ã‚Œã¦ã„ã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¨ä¸€è‡´ã™ã‚‹ã®ã§ã™ãŒã€ãã‚Œã‚’æ›¸ãæ™‚é–“ãŒãªã„ã®ã§ã“ã“ã§ã¯å¼•ãç¶šãã“ã‚Œã‚’ä½¿ã„ã¾ã™ã€‚æ°—ã«ãªã‚‹æ–¹ã¯ <url> <a href="https://www.semanticscholar.org/paper/A-Graph-Free-Approach-to-Data-Flow-Analysis-Mohnen/5ad8cb6b477793ffb5ec29dde89df6b82dbb6dba?p2df">Monhen, 2002</a> </url> ã‚’ã¿ã¦ãã ã•ã„)<br><br><div class="code-block"> <pre><code class="language-julia">function abstract_interpret(I::Program, abstract_semantics::Function, aâ‚€::AbstractState)::Vector{AbstractState}
    n = length(I)
    inputs = [copy(aâ‚€) for _ in 1:n]
    outputs = [copy(aâ‚€) for _ in 1:n]
    pred = build_pred(I) 

    while true
        change = false

        for i in 1:n
            current_input = inputs[i]
            current_output = outputs[i]

            new_input = reduce(âŠ“, outputs[j] for j in pred[i]; init=copy(aâ‚€))
            new_output = abstract_semantics(I[i])(new_input)

            inputs[i] = new_input
            outputs[i] = new_output
            
            if (current_input != new_input) || (current_output != new_output)
                change = true
            end
        end


        if !change
            break
        end
    end           


    return [inputs; outputs[end]]
end
</code></pre> </div><br>å°å…¥ã¯ç°¡å˜ã§ã€<span class="inline-code"> <code>outputs[i]</code> </span> ã®æ›´æ–°ã‚’ã™ã‚‹ã¨ãã« Widening Operator <span class="inline-code"> <code>âˆ‡</code> </span> ã‚’æŒŸã‚ã°è‰¯ã„ã§ã™ã€‚åœæ­¢æ€§ã¨å…ƒã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®è¨¼æ˜ã¨ç…§ã‚‰ã—åˆã‚ã›ã‚Œã°ã€ã“ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®åœæ­¢æ€§ãŒã‚ã‹ã‚Šã¾ã™ã€‚<br><br><div class="code-block"> <pre><code class="language-diff">-function abstract_interpret(I::Program, abstract_semantics::Function, aâ‚€::AbstractState)::Vector{AbstractState}
+function abstract_interpret(I::Program, abstract_semantics::Function, aâ‚€::AbstractState, âˆ‡::Function)::Vector{AbstractState}
     n = length(I)
     inputs = [copy(aâ‚€) for _ in 1:n]
     outputs = [copy(aâ‚€) for _ in 1:n]
@@ -99,7 +99,7 @@ function abstract_interpret(I::Program, abstract_semantics::Function, aâ‚€::Abst
             new_output = abstract_semantics(I[i])(new_input)
 
             inputs[i] = new_input
-            outputs[i] = new_output
+            outputs[i] = âˆ‡(new_output, current_output)
             
             if (current_input != new_input) || (current_output != new_output)
                 change = true
</code></pre> </div><br><br>Widening ã®è¢«è¦†æ€§ã¯ã€é †åºé–¢ä¿‚ <span class="math-inline"> \( \leq \) </span> ã§ã„ã†ã¨ã‚ˆã‚Šå¤§ãã„æ–¹ã«çµæœã‚’æŒã£ã¦ã„ãã“ã¨ã‚’è¦æ±‚ã—ã¦ã„ã¾ã™ã€‚<br>æŠ½è±¡è§£é‡ˆã®æ çµ„ã¿ã«ãŠã„ã¦ã¯ã€ã“ã‚Œã¯ã‚ˆã‚Šæƒ…å ±é‡ãŒå°‘ãªã„å´ã«æƒ…å ±ã‚’ã¾ã¨ã‚ã‚‹ã“ã¨ã«ç›¸å½“ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã£ã¦ Widening ã‚’å°å…¥ã—ã¦ã‚‚ãã®è¦‹ç©ã‚‚ã‚ŠãŒå±é™ºã«ãªã‚‹ (å°ã‘ãªã„ã¯ãšã®äº‹å®ŸãŒå°ã‹ã‚Œã‚‹) ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<br>ã¾ã¨ã‚ã‚‹ã¨ã€Widening ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªã‚‚ã®ã§ã™ã€‚<br><br><div class="info "><br><span class="strong"> <strong>Widening</strong> </span><br>Widening ã¯<br><ul><li>è§£æã®å®‰å…¨ã®ãŸã‚ã® <span class="strong"> <strong>è¢«è¦†æ€§</strong> </span></li><li>è§£æã®åœæ­¢ã®ãŸã‚ã®<span class="strong"> <strong>åœæ­¢æ€§</strong> </span></li></ul><br>ã‚’æº€ãŸã—ãŸ <span class="strong"> <strong>Widening Operator</strong> </span> <span class="math-inline"> \( \nabla \) </span> ã‚’çŠ¶æ…‹æ›´æ–°ã®éš›ã«é©ç”¨ã™ã‚‹ã“ã¨ã§ã€çŠ¶æ…‹æ›´æ–°ã‚’å®‰å…¨ãªå´ã¸ã€Œã‚¹ã‚­ãƒƒãƒ—ã€ã—ã¦æœ‰é™æ™‚é–“ã§ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è§£æå•é¡Œã‚’è¿‘ä¼¼çš„ã«è§£ããŸã‚ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã€‚</div><br><br><script>page_contents.push({
    "type":"H2",
    "id":"1245",
    "title":"å®Ÿè£…"
});
</script>
<h2 id="1245">å®Ÿè£…</h2><br>ãã‚Œã§ã¯å®Ÿéš›ã«ã“ã®ä¸–ã®å…¨ã¦ã‚’å®Ÿè£…ã—ã¦ã„ã“ã†ã¨æ€ã„ã¾ã™ã€‚<br><script>page_contents.push({
    "type":"H3",
    "id":"1250",
    "title":"ãƒ‘ãƒ¼ã‚¹ "
});
</script>
<h3 id="1250">ãƒ‘ãƒ¼ã‚¹ </h3><br>ã“ã‚Œã«é–¢ã—ã¦ã¯ã‚ã¾ã‚Šä»Šå›ã®è¨˜äº‹ã§æœ¬è³ªãƒ‘ãƒ¼ãƒˆã§ãªã„ã®ã§ã€å°‘ã—è»½ã‚ã«èª¬æ˜ã—ã¾ã™ã€‚<br>ä»Šå›ã¯ PEG ã‚’ä½¿ã£ã¦æ§‹æ–‡ã‚’å®šç¾©ã—ã¾ã—ãŸã€‚ãŠå¥½ããªæ–¹æ³•ã§ãƒ‘ãƒ¼ã‚µã‚’å®šç¾©ã—ã¦ã‚‚ã‚‰ãˆã‚Œã°ã¨æ€ã„ã¾ã™ã€‚ é¢å€’ã§ã‚ã‚Œã° Så¼ã‚„ json ã‚’å…¥åŠ›ã«ã—ã¦ã—ã¾ã†ã¨ã„ã†æ‰‹ã‚‚ã‚ã‚Šã¾ã™ã€‚<br>ãƒ‘ãƒ¼ã‚µã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: https://github.com/abap34/mu/tree/main/src/parse<br>AST ã¯ Julia ã®æ§‹é€ ã‚’å‚è€ƒã«ã€ãƒãƒ¼ãƒ‰è‡ªä½“ã®æƒ…å ±ã¨å­ãƒãƒ¼ãƒ‰ã‚’ Vector ã§æŒã¤å½¢å¼ã«ã—ã¾ã™ã€‚<br><div class="code-block"> <pre><code class="language-julia">@enum ExprHead begin
    GCALL # Generic function call
    BCALL # Builtin function call
    ASSIGN     # Assignment

    IFELSE     # If-else statement
    IF         # If statement
    WHILE      # While statement

    PROGRAM    # Special type to represent the whole program
    BLOCK      # Block to group multiple expressions

    FUNCTION   # For function definition
    FORMALARGS # |  Formal arguments for function definition
    TYPEDIDENT # |  Typed identifier. e.g. `a::Array{Int, 2}`
    TYPE       # |  Type. e.g. `Array{Int, 2}`
    RETURN     # |  Return statement

    GOTO         #  Goto label without condition        |
    GOTOIFNOT    #  Goto label if condition is false    | ==&gt; These are for IR.
    LABEL        #  Label for goto                      |     Result of `parse` function will not have these.
end

struct Expr &lt;: AbstractSyntaxNode
    head::ExprHead
    args::Vector{Any} # It is not avoidable to use `Any` here.
end
</code></pre> </div><br><br>ä¾‹ãˆã°<br><div class="code-block"> <pre><code class="language-js">function main(){
    x = [1, 2, 3]
    n = 100

    i = 0

    while (i &lt; n){
        x = expanddims(x)
        i = i + 1
    }

    return x
}
</code></pre> </div><br>ã¨ã„ã†ã‚³ãƒ¼ãƒ‰ã‚’ãƒ‘ãƒ¼ã‚¹ã™ã‚‹ã¨ã€<br><div class="code-block"> <pre><code class="language-julia">julia&gt; mu.MuCore.parse(TESTCASE6) |&gt; dump
# mu.MuCore.MuAST.Expr
#  head: mu.MuCore.MuAST.ExprHead mu.MuCore.MuAST.PROGRAM
#  args: Array{Any}((1,))
#    1: mu.MuCore.MuAST.Expr
#      head: mu.MuCore.MuAST.ExprHead mu.MuCore.MuAST.FUNCTION
#      args: Array{Any}((3,))
#  ... é•·ã„ã®ã§çœç•¥ ...
#                2: Int64 0
#            4: mu.MuCore.MuAST.Expr
#              head: mu.MuCore.MuAST.ExprHead mu.MuCore.MuAST.WHILE
#              args: Array{Any}((2,))
#                1: mu.MuCore.MuAST.Expr
#                2: mu.MuCore.MuAST.Expr
#            5: mu.MuCore.MuAST.Expr
#              head: mu.MuCore.MuAST.ExprHead mu.MuCore.MuAST.RETURN
#              args: Array{Any}((1,))
#                1: mu.MuCore.MuAST.Ident
</code></pre> </div><br>ã¨ã„ã† AST ãŒæ§‹ç¯‰ã•ã‚Œã¾ã™ã€‚Så¼ã£ã½ã„è¦‹ã‚„ã™ã„ printing ã‚’é ‘å¼µã£ã¦æ›¸ãã¨  <figure><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3929241/5ecf6922-90ce-aeeb-0cc7-f6775411944e.png" ><figcaption>image.png</figcaption></figure><br><br>ã¨ã„ã†æ„Ÿã˜ã§ã™ã€‚<br><script>page_contents.push({
    "type":"H3",
    "id":"1278",
    "title":"lowering"
});
</script>
<h3 id="1278">lowering</h3><br><script>page_contents.push({
    "type":"H4",
    "id":"1281",
    "title":"IR ã®è¡¨ç¾"
});
</script>
<h4 id="1281">IR ã®è¡¨ç¾</h4><br>ã•ã¦ã€lowering ã§ã™ã€‚<br>ã“ã‚Œã¯ <span class="inline-code"> <code>Expr</code> </span> ã‚’å—ã‘å–ã£ã¦ç›´åˆ—ã®å‘½ä»¤åˆ—ã«å¤‰æ›ã™ã‚‹ã‚ã‘ã§ã™ãŒã€ä»Šå›ã®å‡¦ç†ç³»ã§ã¯é–¢æ•°å˜ä½ã§ã“ã®ã‚ˆã†ãªå‡¦ç†ãŒè¡Œã‚ã‚Œã¾ã™ã€‚<br><url> <a href="https://github.com/abap34/mu/blob/main/src/lowering/ir.jl">src/lowering/ir.jl</a> </url> ã«ãã‚Œã‚‰å‘½ä»¤åˆ—ã®å®šç¾©ãŒã‚ã‚Šã¾ã™ã€‚<br>ã¾ãšã€å‘½ä»¤ã¯<br><div class="code-block"> <pre><code class="language-julia">@enum InstrType begin
    ASSIGN           # Assignment
    GOTO             # Goto label without condition
    GOTOIFNOT        # Goto label if condition is false.  
    LABEL            # Label for goto
    RETURN           # Return statement
end

struct Instr
    instrtype::InstrType
    expr::MuAST.Expr
end
</code></pre> </div><br>ã¨å®šç¾©ã•ã‚Œã¦ã€IR ã¯ã“ã‚Œã®åˆ— (ã«ã„ãã‚‰ã‹ã®æƒ…å ±ã‚’æŒãŸã›ãŸã‚‚ã®)  ã¨ã—ã¦å®šç¾©ã—ã¾ã™ã€‚<br><div class="code-block"> <pre><code class="language-julia"># Representation of program after lowering.
struct CodeInfo
    instrs::Vector{Instr}
    typed::Bool
    varnames::Vector{MuAST.Ident}
    vartypes::Vector{Union{DataType,Nothing}}
    function CodeInfo()
        return new(Instr[], false, MuAST.Ident[], Union{DataType,Nothing}[])
    end
end
</code></pre> </div><br>ã“ã®ä¸Šã§ã€é–¢æ•°å…¨ä½“ã® lowering ã•ã‚ŒãŸå¾Œã®è¡¨ç¾ã‚’ä¿æŒã™ã‚‹ <span class="inline-code"> <code>MethodInfo</code> </span> ã‚’å®šç¾©ã—ã¾ã™ã€‚<br>é–¢æ•°å, å¼•æ•° (å‹ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®æƒ…å ±ã‚‚å«ã¿ã¾ã™), ãã—ã¦ä¸­èº«ã® IR ã‚’ä¿æŒã—ã¾ã™ã€‚<br><div class="code-block"> <pre><code class="language-julia"># Information of each **method**.
struct MethodInfo
    id::Int                         # id of the method (unique)
    name::MuAST.Ident               # Name of the method (not unique) 
    argname::Vector{MuAST.Ident}    # Argument names (e.g. [`a`, `b`, `c`])
    signature::MuTypes.Signature    # Signature of the method. All elements must be MuTypes.
    ci::CodeInfo                    # IR of the method
end
</code></pre> </div><br><script>page_contents.push({
    "type":"H4",
    "id":"1309",
    "title":"lowering ã®å®Ÿè£…"
});
</script>
<h4 id="1309">lowering ã®å®Ÿè£…</h4><br>ãã‚Œã§ã¯ã€ä¸Šã«ç¤ºã—ãŸè¡¨ç¾ã¸ã®å¤‰æ›ã‚’å®Ÿè£…ã—ã¾ã™ã€‚<br>ã¨ã¯ã„ãˆã€è¡Œã†ã“ã¨ã¯æœ¬å½“ã«å ´åˆã‚ã‘ã‚’é ‘å¼µã‚‹ã“ã¨ã®ã¿ã§ã™ã€‚<br>ä¾‹ãˆã°ã€while æ–‡ã® lowering ã®å‡¦ç†ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚(https://github.com/abap34/mu/blob/33cedc918a83b4fd6ce8b8bc43f1e50236c5075a/src/lowering/lowering.jl#L157)<br><br><div class="code-block"> <pre><code class="language-julia">        ...
        
    elseif expr.head == MuAST.WHILE
        # while (cond) 
        #     body
        #
        # â†“
        # label cond_label
        # goto end_label if not cond
        # body
        # goto cond_label
        # label end_label

        cond, body = expr.args

        cond_label_id = label_gen()
        end_label_id = label_gen()

        pushlabel!(ir, cond_label_id)
        pushgotoifnot!(ir, end_label_id, cond)
        append!(ir, _lowering(body))
        pushgoto!(ir, cond_label_id)
        pushlabel!(ir, end_label_id)
    else
        ...

</code></pre> </div><br>ã‚³ãƒ¡ãƒ³ãƒˆã«ã‚‚ã‚ã‚‹ã‚ˆã†ã«ã€<br><div class="code-block"> <pre><code class="language-plaintext">while (cond) {
    body
}
</code></pre> </div><br>ã¯<br><div class="code-block"> <pre><code class="language-plaintext">label cond_label
goto end_label if not cond
body
goto cond_label
label end_label
</code></pre> </div><br>ã¨å¤‰æ›ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãªã®ã§ã€ãƒ©ãƒ™ãƒ«ã® id ã‚’ç”Ÿæˆã—ã¦ã€ä¸Šã¨ä¸€è‡´ã™ã‚‹ã‚ˆã†ã«é †ç•ªã«å‘½ä»¤ã‚’è¿½åŠ ã—ã¦ã„ã‘ã°è‰¯ã„ã§ã™ã€‚<br>æ³¨æ„ãŒå¿…è¦ãªã‚‚ã®ã¨ã—ã¦ã¯ã€é–¢æ•°å‘¼ã³å‡ºã—ã®ä¸­ã§é–¢æ•°å‘¼ã³å‡ºã—ãŒå«ã¾ã‚Œã‚‹ã‚±ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚<br><div class="code-block"> <pre><code class="language-julia">y = 3 * x + 4
</code></pre> </div><br>ã‚’è€ƒãˆã¦ã¿ã¾ã™ã€‚ã“ã‚Œã¯ã€<br><div class="code-block"> <pre><code class="language-julia">julia&gt; mu.MuCore.parse(&quot;y = 3 * x + 4&quot;)
(PROGRAM

    (ASSIGN y (GCALL add (GCALL mul 3 x) 4))
)
</code></pre> </div><br>ã¨ã„ã† AST ã«ãƒ‘ãƒ¼ã‚¹ã•ã‚Œã¾ã™ãŒã€ä¸­é–“å¤‰æ•° <span class="inline-code"> <code>%1</code> </span> ã‚’å°å…¥ã—ã¦<br><div class="code-block"> <pre><code class="language-julia">%1 = (CALL mul 3 x)
y  = (CALL add %1 4)
</code></pre> </div><br>ã¨ lowering ã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚å³è¾ºãŒå˜ä¸€ã®é–¢æ•°å‘¼ã³å‡ºã—ã—ã‹ã—ãªã„ã“ã¨ã«ã™ã‚‹ã¨å¾Œã®å®Ÿè£…ãŒã—ã‚„ã™ããªã‚‹ã‹ã‚‰ã§ã™ã€‚<br>ãªã®ã§ã€é–¢æ•°å‘¼ã³å‡ºã—ã«å¯¾ã—ã¦ã¯<br><ul><li>å¼•æ•°ã‚’ãƒã‚§ãƒƒã‚¯â†’ ã‚‚ã—å¼ãªã‚‰æ–°ãŸã«å¤‰æ•°å (e.g. <span class="inline-code"> <code>%1</code> </span>) ã‚’ç”Ÿæˆã—ã¦ã€ãã®å¼ã‚’ lowering ã—ã¦ãã®çµæœã‚’ç”Ÿæˆã—ãŸå¤‰æ•°åã«ä»£å…¥â†’ å®šæ•°, å¤‰æ•°ãªã‚‰ãã®ã¾ã¾</li></ul><br>ã¨ã„ã†ã®ã‚’å†å¸°çš„ã«è¡Œã†ã“ã¨ã§å³è¾ºã‚’å˜ä¸€ã®å¤‰æ•°å‘¼ã³å‡ºã—ã«ã—ã¾ã™ã€‚<br><figure><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3929241/51c5d240-aabd-d41d-78cd-5ff2fd3ae4a2.png" ><figcaption>image.png</figcaption></figure><br>å…ˆã»ã©ã®é–¢æ•°ã® lowering çµæœã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚<br><div class="code-block"> <pre><code class="language-julia">julia&gt; mu.MuCore.lowering(ast)
# 1-element Vector{mu.MuCore.MuIR.MethodInstance}:
# function main()
#
# | idx |  instrtype | instr
# | --- | ---------- | ----------------------------------------
# |   1 |     ASSIGN | x = [1, 2, 3]
# |   2 |     ASSIGN | n = 100
# |   3 |     ASSIGN | i = 0
# |   4 |      LABEL | LABEL #29
# |   5 |     ASSIGN | %32 = (GCALL lt i n)
# |   6 |  GOTOIFNOT | GOTO #30 IF NOT %32
# |   7 |     ASSIGN | x = (GCALL expanddims x)
# |   8 |     ASSIGN | i = (GCALL add i 1)
# |   9 |       GOTO | GOTO #29
# |  10 |      LABEL | LABEL #30
# |  11 |     ASSIGN | %ret = x
# |  12 |       GOTO | GOTO RETURN
# |  13 |      LABEL | LABEL RETURN
# |  14 |     RETURN | RETURN %ret
#
# end
</code></pre> </div><br>ã„ã„æ„Ÿã˜ã«ãªã£ã¦ãã¾ã—ãŸã­ã€‚ã“ã“ã¾ã§ããŸã‚‰ç°¡æ˜“çš„ãªã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ã‚’æ›¸ã„ã¦å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚‚ç°¡å˜ã§ã™ã€‚<br>ä»Šå›ã®å‡¦ç†ç³»ã§ã‚‚ Verify ã®ãŸã‚ã«å…·ä½“çš„ãªå®Ÿè¡Œã‚’æ‹…ã† <span class="inline-code"> <code>ConcreateInterpreter</code> </span> ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚<br>https://github.com/abap34/mu/blob/main/src/interpreter/concreateinterpreter.jl<br><script>page_contents.push({
    "type":"H3",
    "id":"1371",
    "title":"å‹æ¨è«–ã®å®Ÿè£…"
});
</script>
<h3 id="1371">å‹æ¨è«–ã®å®Ÿè£…</h3><br><script>page_contents.push({
    "type":"H4",
    "id":"1374",
    "title":"å‹é·ç§»é–¢æ•°ã®å®Ÿè£…"
});
</script>
<h4 id="1374">å‹é·ç§»é–¢æ•°ã®å®Ÿè£…</h4><br>ãã‚Œã§ã¯ã€å‹æ¨è«–ã‚’å®Ÿè£…ã—ã¾ã™ã€‚<br>ãã®ãŸã‚ã«ã¯æŠ½è±¡çŠ¶æ…‹ (ä»Šå›ã¯ä¸Šã§å‡ºã¦ããŸå‹ãŸã¡) ã¨ãã®é †åº (ä»Šå›ã¯è¦ªå­é–¢ä¿‚)ã€ãã—ã¦ lowering ã•ã‚ŒãŸå¾Œã®å„å‘½ä»¤ã«ã¤ã„ã¦ã€æŠ½è±¡çŠ¶æ…‹ãŒã©ã®ã‚ˆã†ã«å¤‰åŒ–ã™ã‚‹ã‹ã‚’è¡¨ã™æ„å‘³é–¢æ•°ã‚’å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚<br>ä¸Šã®å‹ã®é›†åˆã‚’ <span class="math-inline"> \( T \) </span>,  å‘½ä»¤å…¨ä½“ã®é›†åˆã‚’ <span class="math-inline"> \( I \) </span>, å¤‰æ•°ã®é›†åˆã‚’ <span class="math-inline"> \( V \) </span> ã¨ã—ã¾ã™ã€‚<br>æŠ½è±¡çŠ¶æ…‹ã¯ã€å„å¤‰æ•°ã®å‹ã§ã™ã‹ã‚‰ <span class="math-inline"> \( V \) </span> ã‹ã‚‰ <span class="math-inline"> \( T \) </span>ã¸ã®é–¢æ•°ã§ã™ã€‚<br>ãã—ã¦ã€æŠ½è±¡çŠ¶æ…‹ä¸Šã®é †åºé–¢ä¿‚ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å®šã‚ã¾ã™ã€‚<br><span class="math-inline"> \( A_1 \leq A_2 \Leftrightarrow \forall v \in V, A_1(v)  \mathrel{<\colon} A_2(v) \) </span> <br>ã“ã“ã§ <span class="math-inline"> \( \mathrel{<\colon} \) </span> ã¯ä¸Šã§å®šç¾©ã—ãŸè¦ªå­é–¢ä¿‚ã§ã™ã€‚<br>ãã—ã¦æ„å‘³é–¢æ•° <span class="math-inline"> \( ![.!]: I \to (V \to T) \to (V \to T) \) </span> ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å®šã‚ã¾ã™ã€‚<br>(å®Ÿè£…ã¯ <url> <a href="https://github.com/abap34/mu/blob/33cedc918a83b4fd6ce8b8bc43f1e50236c5075a/src/typeinf/abstractsemantics.jl#L73">abstractsemantics.jl ã® `abstract_semantics`</a> </url> ã§ã™)<br><script>page_contents.push({
    "type":"H4",
    "id":"1412",
    "title":"1. <span class="inline-code"> <code>InstrType</code> </span> ãŒ <span class="inline-code"> <code>ASSIGN</code> </span> ä»¥å¤–ã®ã¨ã"
});
</script>
<h4 id="1412">1. <span class="inline-code"> <code>InstrType</code> </span> ãŒ <span class="inline-code"> <code>ASSIGN</code> </span> ä»¥å¤–ã®ã¨ã</h4><br>æŠ½è±¡çŠ¶æ…‹ã¯å¤‰åŒ–ã—ã¾ã›ã‚“.<br><script>page_contents.push({
    "type":"H4",
    "id":"1421",
    "title":"2. <span class="inline-code"> <code>InstrType</code> </span> ãŒ <span class="inline-code"> <code>ASSIGN</code> </span> ã®ã¨ã"
});
</script>
<h4 id="1421">2. <span class="inline-code"> <code>InstrType</code> </span> ãŒ <span class="inline-code"> <code>ASSIGN</code> </span> ã®ã¨ã</h4><br>ã“ã®ã¨ãæŠ½è±¡çŠ¶æ…‹ãŒå¤‰åŒ–ã—ã¾ã™ã€‚<br><span class="math-inline"> \( I_i \) </span> ãŒ <span class="math-inline"> \( \text{var} \in V \) </span> ã¸ã®ä»£å…¥ã ã£ãŸã¨ã—ã¦ã€ <span class="math-inline"> \( ![I_i !] \) </span> ã‚’è€ƒãˆã‚‹ã“ã¨ã«ã—ã¾ã—ã‚‡ã†ã€‚<br> <span class="inline-code"> <code>InstrType</code> </span> ãŒ <span class="inline-code"> <code>ASSIGN</code> </span> ã®ã¨ãã€å³è¾ºã¯<br> 1. ãƒªãƒ†ãƒ©ãƒ«ã¾ãŸã¯å¤‰æ•°ã®ã¨ã  2. builtin ã®å‘¼ã³å‡ºã—  3. generic function ã®å‘¼ã³å‡ºã—<br><br>ã® 3ã¤ã§å°½ãã•ã‚Œã¾ã™ã€‚<br><script>page_contents.push({
    "type":"H5",
    "id":"1448",
    "title":"1 ã®ã¨ã"
});
</script>
<h5 id="1448">1 ã®ã¨ã</h5><br>å˜ã«å³è¾ºã®å€¤ã®å‹ã‚’èª¿ã¹ã¦ãã®å¤‰æ•°ã®æŠ½è±¡çŠ¶æ…‹ã‚’æ›´æ–°ã™ã‚Œã°ã„ã„ã§ã™ã€‚<br>ã¤ã¾ã‚Šã€æŠ½è±¡çŠ¶æ…‹ <span class="math-inline"> \( a \) </span> ã®ã¨ãã«å®šæ•° <span class="math-inline"> \( c \) </span> ã®ä»£å…¥ã«ã‚ˆã£ã¦æ–°ãŸã«å¾—ã‚‰ã‚Œã‚‹æŠ½è±¡çŠ¶æ…‹ <span class="math-inline"> \( a' \) </span> ã¯<br><div class="math-block"> \[ 

a'(v) = \begin{cases}
\text{typeof(c)} &\quad v = \text{var} \\\\
a(v) &\quad  \text{otherwise} \\\\
\end{cases}

 \] </div><br>ã«ãªã‚Šã¾ã™ã€‚(å³è¾ºãŒå¤‰æ•° <span class="math-inline"> \( b \) </span> ã®å ´åˆã¯ä¸Šã®å¼ã§ <span class="math-inline"> \( c \leftarrow a(b) \) </span> ã§ã™.<br>å®Ÿè£…ã¯  <url> <a href="https://github.com/abap34/mu/blob/33cedc918a83b4fd6ce8b8bc43f1e50236c5075a/src/typeinf/abstractsemantics.jl#L28-L38">`abstractsemantics.jl` ã® `abstract_execute.jl`</a> </url> ã«ã‚ã‚Šã¾ã™ã€‚<br><br><script>page_contents.push({
    "type":"H5",
    "id":"1474",
    "title":"2 ã®ã¨ã"
});
</script>
<h5 id="1474">2 ã®ã¨ã</h5><br>ã“ã‚Œã‚‚ç°¡å˜ã§ã€builtin é–¢æ•°ã¯å°‘ãªã„ã®ã§ãã®å‹é·ç§»ã¯æ›¸ãä¸‹ã™ã“ã¨ãŒã§ãã¾ã™ã€‚ ä»Šå›ã¯ <url> <a href="https://github.com/abap34/mu/blob/main/src/builtin/tfuncs.jl">builtins/tfuncs.jl</a> </url> ã«å®Ÿè£…ãŒã‚ã‚Šã¾ã™ã€‚<br><br>Juliaè¨€èªã‚‚ <url> <a href="https://docs.julialang.org/en/v1/devdocs/builtins/">å°‘ãªã„ãƒ“ãƒ«ãƒˆã‚¤ãƒ³é–¢æ•°</a> </url> ãŒã‚ã‚Šã€Compiler/src/tfuncs.jlã€€ã«ãã®å‹é·ç§»ãŒè¨˜è¿°ã•ã‚Œã¦ã„ã¾ã™ã€‚ä¾‹ãˆã°æ¯”è¼ƒæ¼”ç®—å­ã¯ <span class="inline-code"> <code>Bool</code> </span> ã‚’è¿”ã™ã€ãªã©ã¯ <url> <a href="https://github.com/JuliaLang/julia/blob/b682f496bc3fa81f8ee488b50245275f24f5e7db/Compiler/src/tfuncs.jl#L278">ã“ã®ã‚ˆã†ã«</a> </url> å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚<br><br>ã“ã®ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸå‹é·ç§»é–¢æ•°ã‚’ <span class="math-inline"> \( T_{\text{builtin}} \) </span> ã¨æ›¸ãã“ã¨ã«ã™ã‚‹ã¨ã€<span class="math-inline"> \( T_{\text{builtin}} \) </span> ã¯ä»Šå›ã®è¨­å®šã§ã¯ãƒ“ãƒ«ãƒˆã‚¤ãƒ³é–¢æ•°ã®åå‰ã¨å¼•æ•°ã®å‹ã‚’å—ã‘å–ã£ã¦å¸°ã‚Šå€¤ã®å‹ <span class="math-inline"> \( T \) </span> ã‚’è¿”ã™ã‚ˆã†ãªé–¢æ•°ã§ã™ã€‚<br>ã¤ã¾ã‚Š  <span class="math-inline"> \( \text{var} := f(t_{\text{arg}}) \) </span> ã§ã¯<br><div class="math-block"> \[ 

a'(v) = \begin{cases}
T_{\text{builtin}}(f, t_{\text{arg}}) &\quad v = \text{var} \\\\
a(v) &\quad  \text{otherwise} \\\\
\end{cases}

 \] </div><br>ã¨ãªã‚Šã¾ã™ã€‚<br><script>page_contents.push({
    "type":"H5",
    "id":"1507",
    "title":"3ã®ã¨ã"
});
</script>
<h5 id="1507">3ã®ã¨ã</h5><br>ã•ã¦ã€å•é¡Œã¯ 3. ã® generic function ã®å‘¼ã³å‡ºã—ã§ã™ã€‚<br>ä¾‹ãˆã°æ¨è«–ã®ã‚ã‚‹æ®µéšã§ <span class="inline-code"> <code>x</code> </span> ãŒ <span class="inline-code"> <code>Int</code> </span> ã¾ãŸã¯ <span class="inline-code"> <code>Float</code> </span> ã§ã‚ã‚‹ã“ã¨ãŒåˆ¤æ˜ã—ã¦ã„ã‚‹ã¨ã—ã¦ã€generic function <span class="inline-code"> <code>f</code> </span> ãŒ <span class="inline-code"> <code>Int</code> </span> ã«å¯¾ã™ã‚‹å®Ÿè£…ã‚‚ <span class="inline-code"> <code>Float</code> </span> ã«å¯¾ã™ã‚‹å®Ÿè£…ã‚‚æŒã£ã¦ã„ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚<br>ã“ã®ã¨ã <span class="inline-code"> <code>f(x)</code> </span> ã¯ã©ã¡ã‚‰ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å‘¼ã³å‡ºã—ã«ã‚‚ãªã‚Šãˆã¾ã™ã‹ã‚‰ã€ãã®è¿”ã‚Šå€¤ã®é›†åˆã‹ã‚‰ã€å®‰å…¨ã§ã‚ã£ã¦æœ€ã‚‚å…·ä½“çš„ãªã‚‚ã®ã€ã¤ã¾ã‚Šæœ€å°ä¸Šç•Œã‚’å–ã‚Œã°è‰¯ã„ã§ã™ã€‚<br><br><div class="info"><span class="strong"> <strong>é–¢æ•°å‘¼ã³å‡ºã—ã®å‹é·ç§»</strong> </span><br>generic function <span class="math-inline"> \( f \) </span> ã‚’å¼•æ•° <span class="math-inline"> \( t_{\text{arg}} \) </span> ã§å‘¼ã³å‡ºã—ãŸã¨ãã®å‹é·ç§»é–¢æ•° <span class="math-inline"> \( T_{\text{generic}} \) </span> ã¯ã€ãƒ¡ã‚½ãƒƒãƒ‰ã®å‹é·ç§»ã‚’ <span class="math-inline"> \( T_{\text{method}} \) </span>,  å‘¼ã³å‡ºã—ã†ã‚‹ã‚·ã‚°ãƒãƒãƒ£ã¨å®Ÿè£…ã®çµ„ <span class="math-inline"> \( (s, g) \) </span> ã®é›†åˆã‚’ <span class="math-inline"> \( \mathcal{M} \) </span> ã¨ã—ã¦<br><br><div class="math-block"> \[ 

T_{\text{generic}}(f, t_{\text{arg}}) = \bigsqcup_{(s, g) \in \mathcal{M}} T_{\text{method}}(g, t_{\text{arg}} \sqcap s)

 \] </div><br></div><br><br>ã“ã“ã§ã€<span class="math-inline"> \( T_{\text{method}} \) </span> ã®è¨ˆç®—ã“ããŒæ±‚è§£ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ä»•äº‹ã§ã™ã€‚ã“ã®ä¸­ã§ã‚‚ <span class="math-inline"> \( T_{\text{generic}} \) </span> ã¯ä½¿ã„ã¾ã™ãŒã€generic function <span class="math-inline"> \( f \) </span> ã®å‘¼ã³å‡ºã—ã¯æœ€çµ‚çš„ã«ã¯ builtin ã®å‘¼ã³å‡ºã—ã«åˆ°é”ã—ã¾ã™ã‹ã‚‰å¿…ãšè¨ˆç®—å¯èƒ½ã§ã™ï¼<br><div class="danger">ã¨è¨€ã„ãŸã„ã¨ã“ã‚ãªã®ã§ã™ãŒä»Šå›ã¯å®Ÿè£…ã®ç…©é›‘ã•å›é¿ã®ãŸã‚ã«èª¤é­”åŒ–ã—ã‚’ã—ã¦ã„ã¦ã€ã†ã¾ãã„ã‹ãªã„ã‚±ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚æœ«å°¾ã® ã€Œã“ã®è¨˜äº‹ã§èª¤é­”åŒ–ã—ã¦ã„ã‚‹ã¨ã“ã‚ã€ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</div><br><br>å®Ÿè£…ã¯ <url> <a href="https://github.com/abap34/mu/blob/33cedc918a83b4fd6ce8b8bc43f1e50236c5075a/src/typeinf/abstractsemantics.jl#L5">typeinf/abstractsemantics.jl ã® `_abstract_generis_call`</a> </url> ã«ã‚ã‚Šã¾ã™ã€‚<br><url> <a href="https://github.com/abap34/mu/blob/33cedc918a83b4fd6ce8b8bc43f1e50236c5075a/src/typeinf/abstractsemantics.jl#L12">12è¡Œç›®ã‹ã‚‰ã® foræ–‡</a> </url> ãŒå³è¾ºã®è¨ˆç®—ã§ã™ã€‚<br><br><script>page_contents.push({
    "type":"H4",
    "id":"1576",
    "title":"widening ã®å®Ÿè£…"
});
</script>
<h4 id="1576">widening ã®å®Ÿè£…</h4><br>ç¶šã„ã¦ widening ã‚’å®Ÿè£…ã—ã¾ã™ã€‚ä»Šå›ã¯æ¬¡ã®ã‚ˆã†ãª widening ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚<br><ul><li><span class="inline-code"> <code>Union</code> </span> å‹ã®å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒ 10å€‹ã‚’è¶…ãˆã‚‹ã¾ã§ã¯æ›´æ–°ã‚’ç¶šã‘ã‚‹.</li><li>10å€‹ã‚’è¶…ãˆãŸã‚‰ã€å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ã†ã¡å…±é€šã®è¦ªã§ã‚ã£ã¦æœ€å°ã® abstract type ã«ã™ã‚‹</li></ul><br>ä»Šå›ã¯ç„¡é™ä¸Šæ˜‡é–ã®æ§‹æˆã¯ <span class="inline-code"> <code>Union</code> </span>å‹ã‚’ä½¿ã£ãŸã‚‚ã®ã®ã¿ã§ã‚ã‚‹ã“ã¨ã€abstract type ãŒæœ‰é™ã§ã‚ã‚‹ã“ã¨ã‹ã‚‰ã“ã‚Œã¯ Widening Operator ã§ã™ã€‚<br>ã“ã‚Œã‚’çµ„ã¿è¾¼ã‚“ã æ±‚è§£ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã§ã€å‹æ¨è«–ã¯å¸¸ã«åœæ­¢ã—ã¾ã™ï¼<br>å®Ÿè£…ã¯ <url> <a href="https://github.com/abap34/mu/blob/33cedc918a83b4fd6ce8b8bc43f1e50236c5075a/src/typeinf/solver.jl#L53-L61">`typeinf/solver.jl` ã® `âˆ‡`</a> </url>  ã«ã‚ã‚Šã¾ã™ã€‚<br><script>page_contents.push({
    "type":"H2",
    "id":"1598",
    "title":"å®Ÿè¡Œ"
});
</script>
<h2 id="1598">å®Ÿè¡Œ</h2><br>ã“ã“ã¾ã§ã‚’å®Ÿè£…ã™ã‚Œã°ã€(å¤šå°‘ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æ•´ãˆã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã™ãŒã€) å‹æ¨è«–ãŒå‹•ãã‚ˆã†ã«ãªã‚Šã¾ã™ï¼<br>è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚<br>æ¬¡ã®ã‚ˆã†ãªã¨ã¦ã‚‚å˜ç´”ãªä¾‹ã§è¦‹ã¦ã¿ã¾ã™ã€‚<br><div class="code-block"> <pre><code class="language-julia">function f(){
    if (true){
        if (true){
            return 1
            } else {
                return 1.0
            }
        } else {
            return &quot;hello&quot;
        }
    }
}
</code></pre> </div><br>ã“ã®é–¢æ•°ã®è¿”ã‚Šå€¤ã®å‹ã‚’æ¨è«–ã—ã¦ã¿ã‚‹ã¨...<br><div class="code-block"> <pre><code class="language-julia">julia&gt; ast = MuCore.parse(src);   # ãƒ‘ãƒ¼ã‚¹

julia&gt; lowerd = MuCore.lowering(ast);   # lowering

julia&gt; mt = MuBase.load_base(); # æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å…¥ã£ãŸãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ç”¨æ„

julia&gt; MuCore.MuInterpreter.load!(mt, lowerd); # ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ãƒ¼ãƒ–ãƒ«ã« src ã‚’ãƒ­ãƒ¼ãƒ‰

julia&gt; MuTypeInf.return_type(lowerd[end], argtypes=[], mt=mt)  # æ¨è«–ï¼
mu.MuCore.MuTypes.Union{mu.MuCore.MuTypes.Union{mu.MuCore.MuTypes.Int, mu.MuCore.MuTypes.Float}, mu.MuCore.MuTypes.String}
</code></pre> </div><br>ğŸ¥³ğŸ¥³ğŸ‰ è¦‹äº‹ï¼ è¿”ã‚Šå€¤ã¯ <span class="inline-code"> <code>Int</code> </span> ã¾ãŸã¯ <span class="inline-code"> <code>Float</code> </span> ã¾ãŸã¯ <span class="inline-code"> <code>String</code> </span> ã¨æ¨è«–ã§ãã¦ã„ã¾ã™ ğŸ‰ğŸ¥³ğŸ¥³<br>ã•ã‚‰ã«ã€è‰²ã€…è©¦ã›ã‚‹ã‚ˆã†ã€mu ã¯ muè‡ªèº«ã§æ›¸ã‹ã‚ŒãŸ (ã¨ã¦ã‚‚è²§å¼±ã§åã£ãŸ) æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å‚™ãˆã¦ã„ã¾ã™: <url> <a href="https://github.com/abap34/mu/blob/main/src/base/base.jl">src/base/base.jl</a> </url><br>ã“ã‚Œã‚’ä½¿ã£ã¦ã€widening ã®åŠ¹æœã‚’å®Ÿæ„Ÿã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚<br>æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ãŒæ›¸ã‘ã¾ã™ã€‚<br><div class="code-block"> <pre><code class="language-julia">function expanddims(arr::AbstractArray){
    result_size = append(size(arr), 1)
    return reshape(arr, result_size)
}

function main(){
    x = [1, 2, 3]
    n = 100

    i = 0

    while (i &lt; n){
        x = expanddims(x)
        i = i + 1
    }

    return x
}
</code></pre> </div><br><span class="inline-code"> <code>expanddims</code> </span> ã¯ã€é…åˆ—ã®æ¬¡å…ƒã‚’å¢—ã‚„ã™ã‚ˆã†ãªæ“ä½œã§ã™ã€‚ (ã‚‚ã¡ã‚ã‚“ã“ã‚Œã¯ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ã§ã¯ãªãã€æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã® <span class="inline-code"> <code>size</code> </span> ã‚„ <span class="inline-code"> <code>reshape</code> </span> ãªã©ã«ã‚ˆã£ã¦æ›¸ã‹ã‚ŒãŸæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®é–¢æ•°ã§ã™ã€‚)<br>ã“ã® <span class="inline-code"> <code>main</code> </span> ã®è¿”ã‚Šå€¤ã®å‹ã‚’æ¨è«–ã—ã¦ã¿ã¾ã™ã€‚<br><div class="code-block"> <pre><code class="language-julia">julia&gt; ast  = MuCore.parse(src);

julia&gt; lowerd = MuCore.lowering(ast);

julia&gt; mt = MuBase.load_base();

julia&gt; MuCore.MuInterpreter.load!(mt, lowerd);

julia&gt; MuTypeInf.return_type(lowerd[end], argtypes=[], mt=mt)
mu.MuCore.MuTypes.AbstractArray
</code></pre> </div><br>ã“ã®ã‚ˆã†ã« <span class="inline-code"> <code>AbstractArray</code> </span> ã¨æ¨è«–ã§ãã¦ã„ã¾ã™ï¼<br><br>ã“ã‚Œã¯ widening ã«ã‚ˆã‚‹åŠ¹æœã§ã€while æ–‡ã®ä¸­ã§ <span class="inline-code"> <code>Union{Array{Int, 1}, Array{Int, 2},Array{Int, 3}...}</code> </span> ã¨æ›´æ–°ã•ã‚Œã€ã“ã‚ŒãŒ 10å›ç¹°ã‚Šè¿”ã•ã‚ŒãŸæ™‚ç‚¹ã§ widening ã«ã‚ˆã£ã¦å…±é€šã®è¦ªã§ã‚ã‚‹ <span class="inline-code"> <code>AbstractArray</code> </span> ã«ãªã‚Šã€æ¨è«–ãŒåæŸã—ã¦ã„ã‚‹ã‚ã‘ã§ã™ï¼<br><br>ã¡ãªã¿ã«ã€ã©ã®ã‚ˆã†ãªæ¨è«–ãŒã§ãã‚‹ã‹ã¯ <url> <a href="https://github.com/abap34/mu/blob/main/test/typeinf.jl">å‹æ¨è«–ã®ãƒ†ã‚¹ãƒˆ</a> </url> ã‚’è¦‹ã‚‹ã¨è‰²ã€…ã‚ã‚‹ã®ã§çœºã‚ã¦ã¿ã¦ã‚‚é¢ç™½ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚<br><script>page_contents.push({
    "type":"H2",
    "id":"1659",
    "title":"ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã®é™çš„è§£æ±º"
});
</script>
<h2 id="1659">ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã®é™çš„è§£æ±º</h2><br>ã“ã“ã¾ã§æ¥ã‚Œã°ã“ã£ã¡ã®ã‚‚ã®ã§ã€å‹æ¨è«–ã«ã‚ˆã£ã¦å„å‘½ä»¤ã®å®Ÿè¡Œç›´å‰ã®å¤‰æ•°ã®å‹ãŒã„ãã‚‰ã‹ã‚ã‹ã‚Šã¾ã™ã‹ã‚‰ã€ãƒãƒƒãƒã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ãŒä¸€ã¤ã«é™ã‚‰ã‚Œã‚‹ã‹ã‚’èª¿ã¹ã¦ã€ãã‚Œã«ã‚ˆã£ã¦ç½®ãæ›ãˆã‚Œã°è‰¯ã„ã§ã™ã€‚<br>(ã™ã¿ã¾ã›ã‚“ã€ã“ã‚Œã¯ã‚¿ã‚¤ãƒˆãƒ«è©æ¬ºã§ã€ã“ã®ç½®æ›ã¯ã¾ã æœªå®Ÿè£…ã§ã™ã€‚ã“ã“ã¾ã§æ¥ãŸã‚‰ LLVM ã‚’ä½¿ã£ã¦ãƒã‚¤ãƒŠãƒªã‚’åã‘ã‚‹ã‚ˆã†ã«ãªã‚‹æ–¹ãŒçµ¶å¯¾é¢ç™½ã„ã¨æ€ã†ã®ã§ä»Šå¾Œã“ã®éƒ¨åˆ†ã¯æ›¸ãã¾ã™ã€‚)<br>ã“ã†ã—ã¦é«˜é€Ÿãªå®Ÿè¡ŒãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚<br><script>page_contents.push({
    "type":"H2",
    "id":"1668",
    "title":"ã“ã®è¨˜äº‹ã§èª¤é­”åŒ–ã—ã¦ã„ã‚‹ã¨ã“ã‚"
});
</script>
<h2 id="1668">ã“ã®è¨˜äº‹ã§èª¤é­”åŒ–ã—ã¦ã„ã‚‹ã¨ã“ã‚</h2><br>Julia ã®å‡¦ç†ç³»ã¨æ¯”è¼ƒã™ã‚‹ã¨å½“ç„¶å¤§é‡ã®ç°¡ç•¥åŒ–ãŒå…¥ã£ã¦ã„ã‚‹ã‚ã‘ã§ã™ãŒã€ä¸»è¦ãªç‚¹ã‚’æŒ™ã’ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªã‚‚ã®ãŒã‚ã‚Šã¾ã™.<br><br><ol><li>å‹ã‚·ã‚¹ãƒ†ãƒ ã®ç°¡ç•¥åŒ–ã€€â”€ ãƒ¦ãƒ¼ã‚¶å®šç¾©å‹ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã—Julia ã®å‹ã‚·ã‚¹ãƒ†ãƒ ã¯ã‚‚ã†å°‘ã—è¡¨ç¾åŠ›è±Šã‹ã§ã™ã€‚</li><li>ç›¸äº’å†å¸°ã®ã‚µãƒãƒ¼ãƒˆ â”€ å®Ÿã¯ä»Šå›ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã ã‘ã§ã¯ç›¸äº’å†å¸°ã§ç„¡é™ãƒ«ãƒ¼ãƒ—ã«ãªã‚‹ã‚±ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚Julia æœ¬ä½“ã§ã¯ç›¸äº’å†å¸°ã‚’å«ã‚€é–¢æ•°å‘¼ã³å‡ºã—ã§ã‚‚åœæ­¢ã—ã¾ã™ã€‚</li><li>ãƒ“ãƒ«ãƒˆã‚¤ãƒ³é–¢æ•°ãŒã¡ã‚‡ã£ã¨ãƒªãƒƒãƒ â”€ Julia ã®ãƒ“ãƒ«ãƒˆã‚¤ãƒ³é–¢æ•°ã¯ã‚‚ã†å°‘ã—æ´—ç·´ã•ã‚Œã¦ãŠã‚Šã€ç‰¹ã«é…åˆ—æ“ä½œå‘¨ã‚Šã¯ä»Šå›ã¯èª¤é­”åŒ–ã—ã¦ã‚„ã‚„é«˜ãƒ¬ãƒ™ãƒ«ãªæ“ä½œãŒå…¥ã£ã¦ã„ã¾ã™ã€‚</li><li>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚é–“ã®è€ƒæ…®ãŒãªã„ â”€ å…¨ã¦ã‚’æ¨è«–ã—ã¦ã„ã¾ã™ã€‚</li></ol><br><br><script>page_contents.push({
    "type":"H2",
    "id":"1685",
    "title":"æ„Ÿæƒ³"
});
</script>
<h2 id="1685">æ„Ÿæƒ³</h2><br>ã‚„ã¯ã‚Šè‡ªåˆ†ã§å®Ÿè£…ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦è‰²ã€…ã¨æ˜ç¢ºã«ãªã£ã¦ã‚ˆã‹ã£ãŸã§ã™ã€‚ æ¬¡ã¯ SSA IR ã®æœ€é©åŒ–ãƒ‘ãƒ¼ãƒˆã‚’èª­ã‚“ã§ã¿ã‚ˆã†ã‹ã¨æ€ã„ã¾ã™ã€‚<br><br><script>page_contents.push({
    "type":"H2",
    "id":"1691",
    "title":"å‚è€ƒã«ã—ãŸæ–‡çŒ®"
});
</script>
<h2 id="1691">å‚è€ƒã«ã—ãŸæ–‡çŒ®</h2><br><ul><li>Bezanson, Jeffrey Werner. Abstraction in technical computing. Diss. Massachusetts Institute of Technology, 2015.</li><li>Cortesi, Agostino. "Widening operators for abstract interpretation." 2008 Sixth IEEE International Conference on Software Engineering and Formal Methods. IEEE, 2008.</li><li>https://github.com/aviatesk/grad-thesis</li><li>https://github.com/JuliaLang/julia</li></ul><br><br><div class="footnote"><span class="footnote-def" id="label_scitokyo"><a href="#ref_scitokyo">[scitokyo]</a> https://x.com/Ag_smith/status/1871469153233826192</span><span class="footnote-def" id="label_jitcompile"><a href="#ref_jitcompile">[jitcompile]</a> Julia ã¯é–¢æ•°ãŒåˆè¦‹ã®å‹ã®çµ„ã®å¼•æ•°ã§å‘¼ã³å‡ºã•ã‚ŒãŸã¾ã•ã«ãã®ã¨ãã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã‚‹ã¨ã„ã†æ„å‘³ã§ JIT ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ–¹å¼ã®è¨€èªã¨ä½ç½®ä»˜ã‘ã‚‰ã‚Œã¦ã„ã¾ã™ãŒã€ ä¾‹ãˆã° V8 ãŒã™ã‚‹ã‚ˆã†ãªTracing ã«ã‚ˆã‚‹æœ€é©åŒ–ã¯è¡Œã„ã¾ã›ã‚“ã€‚ãªã®ã§ Julia ã¯å˜ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãŒé…ã‹ã£ãŸã‚Šãƒã‚¤ãƒŠãƒªã‚’æ˜ç¤ºçš„ã«åå‰ãŒã¤ã„ãŸãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦å‡ºåŠ›ã—ãªã„ã ã‘ã§ã€å®Ÿè£…ã®å®Ÿæ…‹ã¯ AoT ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã«è¿‘ã„ã§ã™ã€‚</span><span class="footnote-def" id="label_arrayattent"><a href="#ref_arrayattent">[arrayattent]</a> (å…¨ã¦ã®è¦ç´ ãŒ <span class="inline-code"> <code>T</code> </span> ãªã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ä¾‹ãˆã° <span class="inline-code"> <code>typeof(Real[1, 2.5, 3.5][1])</code> </span> ã¯ <span class="inline-code"> <code>Int</code> </span> ã§ã™.)</span><span class="footnote-def" id="label_bottom"><a href="#ref_bottom">[bottom]</a> Julia ã«ãŠã„ã¦ã¯ <span class="inline-code"> <code>Union</code> </span> ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ç©ºã¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™: <span class="inline-code"> <code>Union{}</code> </span>. Julia ã«ãŠã„ã¦ã¯ã“ã®å‹ã¯ <span class="inline-code"> <code>Core.TypeofBottom</code> </span> ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã§ã€ã“ã®è¨˜äº‹ã§ã„ã†ã¨ã“ã‚ã® <span class="inline-code"> <code>Bottom</code> </span> å‹ã«ã‚ãŸã‚Šã¾ã™ã€‚</span><span class="footnote-def" id="label_juliasubtyping"><a href="#ref_juliasubtyping">[juliasubtyping]</a> Zappa Nardelli, Francesco, et al. "Julia subtyping: a rational reconstruction." Proceedings of the ACM on Programming Languages 2.OOPSLA (2018): 1-27.</span><span class="footnote-def" id="label_juliasubtypingdecide"><a href="#ref_juliasubtypingdecide">[juliasubtypingdecide]</a> Belyakova, Julia, et al. "Decidable Subtyping of Existential Types for Julia." Proceedings of the ACM on Programming Languages 8.PLDI (2024): 1091-1114.</span><span class="footnote-def" id="label_jlsubtyping_undecidable"><a href="#ref_jlsubtyping_undecidable">[jlsubtyping_undecidable]</a> Belyakova, Julia, et al. "Decidable Subtyping of Existential Types for Julia." Proceedings of the ACM on Programming Languages 8.PLDI (2024): 1091-1114.</span><span class="footnote-def" id="label_fastsubtyping"><a href="#ref_fastsubtyping">[fastsubtyping]</a> Chung, Benjamin, Francesco Zappa Nardelli, and Jan Vitek. "Julia's efficient algorithm for subtyping unions and covariant tuples (Pearl)." ECOOP 2019-33rd European Conference of Object-Oriented Programming. 2019.</span><span class="footnote-def" id="label_setwidening"><a href="#ref_setwidening">[setwidening]</a> ã‚ˆã‚Šä¸€èˆ¬ã«é›†åˆã«å¯¾ã™ã‚‹æ¼”ç®—ã¨ã—ã¦ Widening Operator ã‚’å®šç¾©ã™ã‚‹æ–¹æ³•ã‚‚ã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ set-Widening Operator ãªã©ã¨å‘¼ã°ã‚Œã¾ã™. è©³ã—ãã¯  Cortesi, 2008 ãªã©ã‚’ã¿ã¦ãã ã•ã„ (å‚è€ƒæ–‡çŒ®ã«ã‚ã‚Šã¾ã™)</span></div>
            <hr>
            <!-- ã‚³ãƒ¡ãƒ³ãƒˆæ¬„ (Utterances) -->
            <script src="https://utteranc.es/client.js" repo="abap34/abap34com-comment" issue-term="og:title"
                label="comment" theme="github-light" crossorigin="anonymous" async>
                </script>
        </div>

        <footer>
            <p>&copy; abap34</p>
        </footer>
    </div>

    <!-- 4) TOC è‡ªå‹•ç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆãªã© -->
    <script>
        const tocContainer = document.querySelector("#toc");
        const tocTitle = document.createElement("div");
        tocTitle.innerHTML = title;
        tocTitle.classList.add("toc_title");
        tocContainer.appendChild(tocTitle);

        // TOC è¦ç´ ç”Ÿæˆ
        page_contents.forEach(item => {
            if (item.type == "H1" || item.type === "H2" || item.type === "H3") {
                const listItem = document.createElement("li");
                listItem.innerHTML = `<a href="#${item.id}">${item.title}</a>`;
                listItem.classList.add("toc_" + item.type);
                tocContainer.appendChild(listItem);
            }
        });

        // IntersectionObserver ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«æ™‚ã« active æ›´æ–°
        const options = {
            root: null,
            rootMargin: "-50% 0px",
            threshold: 0
        };
        const observer = new IntersectionObserver(onIntersection, options);

        page_contents.forEach(item => {
            const element = document.getElementById(item.id);
            if (element) observer.observe(element);
        });

        const first_item = document.querySelector(`#toc a[href="#${page_contents[0].id}"]`);
        first_item.classList.add("active");
        let prev_item = first_item;

        function onIntersection(entries) {
            entries.forEach(entry => {
                const id = entry.target.id;
                const tocItem = document.querySelector(`#toc a[href="#${id}"]`);
                if (tocItem) {
                    if (entry.isIntersecting) {
                        tocItem.classList.add("active");
                        prev_item.classList.remove("active");
                        prev_item = tocItem;
                    }
                }
            });
        }

        // ã‚¿ã‚°è£…é£¾
        let tag = document.querySelector(".tag-placeholder").innerHTML;
        document.querySelector(".tag-placeholder").innerHTML = "";
        tag = tag.replace("[", "").replace("]", "").split(", ").map(t => t.trim());

        tag.forEach(t => {
            const each_tag = document.createElement("span");
            each_tag.classList.add("tag");
            each_tag.innerHTML = "<a href='https://abap34.com/search?tag=" + t + "'> # " + t + "</a>";
            document.querySelector(".tag-placeholder").appendChild(each_tag);
        });

        function applyTheme(theme) {
            if (theme === 'dark') {
                document.body.classList.add('dark-mode');
                document.getElementById('theme-toggle').textContent = 'â˜€ï¸';
            } else {
                document.body.classList.remove('dark-mode');
                document.getElementById('theme-toggle').textContent = 'ğŸŒ™';
            }
        }

        // åˆæœŸè¡¨ç¤ºï¼šlocalStorage ã«ä¿å­˜ã•ã‚ŒãŸãƒ†ãƒ¼ãƒãŒã‚ã‚Œã°ãã‚Œã‚’é©ç”¨ã—ã€ãªã‘ã‚Œã° OS ã®è¨­å®šã«å¾“ã†
        let storedTheme = localStorage.getItem('theme');
        if (storedTheme) {
            applyTheme(storedTheme);
        } else {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                applyTheme('dark');
                localStorage.setItem('theme', 'dark');
            } else {
                applyTheme('light');
                localStorage.setItem('theme', 'light');
            }
        }

        const themeToggleButton = document.getElementById('theme-toggle');

        // ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
        themeToggleButton.addEventListener('click', function () {
            let newTheme = document.body.classList.contains('dark-mode') ? 'light' : 'dark';
            applyTheme(newTheme);
            localStorage.setItem('theme', newTheme);
        });
    </script>

    </script>

</body>

</html>
